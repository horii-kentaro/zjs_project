<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>システム動作確認・問題調査報告書 - 脆弱性管理システム</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .metadata {
            background: #f8f9fa;
            padding: 20px 40px;
            border-bottom: 3px solid #11998e;
        }

        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .metadata-item {
            display: flex;
            flex-direction: column;
        }

        .metadata-label {
            font-weight: bold;
            color: #11998e;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .metadata-value {
            color: #333;
            font-size: 1.1em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8em;
            color: #11998e;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #11998e;
        }

        .subsection-title {
            font-size: 1.4em;
            color: #0f7d72;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .problem-box {
            background: #ffe6e6;
            border-left: 4px solid #dc3545;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        th {
            background: #11998e;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
            margin-right: 5px;
        }

        .badge-normal {
            background: #28a745;
            color: white;
        }

        .badge-issue {
            background: #ffc107;
            color: #333;
        }

        .badge-critical {
            background: #dc3545;
            color: white;
        }

        .badge-ux {
            background: #17a2b8;
            color: white;
        }

        .footer {
            background: #f8f9fa;
            padding: 30px 40px;
            text-align: center;
            border-top: 3px solid #11998e;
            color: #6c757d;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .highlight {
            background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
        }

        .file-path {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border-left: 3px solid #11998e;
        }

        .action-item {
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 5px;
            display: flex;
            align-items: flex-start;
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
        }

        .action-number {
            font-weight: bold;
            margin-right: 10px;
            font-size: 1.2em;
            color: #2196F3;
            min-width: 30px;
        }

        ol, ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>システム動作確認・問題調査報告書</h1>
            <div class="subtitle">脆弱性管理システム - 運用状況と問題分析</div>
        </div>

        <div class="metadata">
            <div class="metadata-grid">
                <div class="metadata-item">
                    <div class="metadata-label">プロジェクト名</div>
                    <div class="metadata-value">脆弱性管理システム</div>
                </div>
                <div class="metadata-item">
                    <div class="metadata-label">実施日</div>
                    <div class="metadata-value">2026年1月14日</div>
                </div>
                <div class="metadata-item">
                    <div class="metadata-label">報告者</div>
                    <div class="metadata-value">システム管理チーム</div>
                </div>
                <div class="metadata-item">
                    <div class="metadata-label">調査ステータス</div>
                    <div class="metadata-value">完了</div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- エグゼクティブサマリー -->
            <div class="section">
                <h2 class="section-title">📋 エグゼクティブサマリー</h2>
                <div class="success-box">
                    <p><strong>調査目的：</strong> システムの動作状況を確認し、ユーザーから報告された3つの疑問点（取得件数の誤解、データベースカラムの説明不足、GitHub Actionsワークフローの動作不明）を解明する。</p>
                    <p style="margin-top: 10px;"><strong>総合結果：</strong> システムは<span class="highlight">正常に動作</span>しており、GitHub Actions CI/CDも健全に稼働中。発見された問題は主に<span class="highlight">UIの表示とドキュメント不足</span>に起因するユーザーエクスペリエンスの課題。</p>
                </div>

                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-label">調査項目数</div>
                        <div class="metric-value">3</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">発見された問題</div>
                        <div class="metric-value">2</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">GitHub Actionsワークフロー</div>
                        <div class="metric-value">2</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">ファイル調査数</div>
                        <div class="metric-value">5</div>
                    </div>
                </div>
            </div>

            <!-- 問題① 取得件数表示の誤解 -->
            <div class="section">
                <h2 class="section-title">🔍 問題① 取得件数表示の誤解</h2>

                <div class="warning-box">
                    <h3 style="margin-bottom: 10px;"><strong>報告内容</strong></h3>
                    <p>http://localhost:8347/ の「JVN iPediaから取得」ボタンを押下後、「取得件数」が633件と表示されるが、PGAdminとlocalhost:8347のレコード数は1,327件となっており、数値が一致しない。</p>
                </div>

                <h3 class="subsection-title">調査結果</h3>
                <div class="file-path">
                    <strong>調査ファイル：</strong> src/api/vulnerabilities.py (225-226行目)
                </div>

                <div class="info-box">
                    <h4 style="margin-bottom: 10px;">技術的な説明</h4>
                    <p>「取得件数」として表示される<strong>633件</strong>は、JVN iPedia APIから<strong>新たに取得した件数</strong>を示しています。一方、データベース全体のレコード数は<strong>1,327件</strong>であり、これは過去の取得処理で蓄積された全データを含みます。</p>
                    <p style="margin-top: 10px;"><strong>つまり：</strong></p>
                    <ul>
                        <li>633件 = 今回のAPIリクエストで取得した新規/更新データ</li>
                        <li>1,327件 = データベースに保存されている総レコード数</li>
                        <li>差分 = 過去の取得処理で既に保存済みのデータ</li>
                    </ul>
                </div>

                <h3 class="subsection-title">原因分析</h3>
                <div class="problem-box">
                    <p><span class="badge badge-ux">UX問題</span> <strong>UIの用語が不明確</strong></p>
                    <p style="margin-top: 10px;">現在の表示では「取得件数」が以下のどちらを指すのか区別がつかず、ユーザーに誤解を与えています：</p>
                    <ul>
                        <li>APIから取得した新規データ件数（実際の意味）</li>
                        <li>データベース全体のレコード数（ユーザーの期待値）</li>
                    </ul>
                </div>

                <h3 class="subsection-title">影響評価</h3>
                <table>
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>評価</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>機能的正常性</td>
                            <td><span class="badge badge-normal">正常</span></td>
                            <td>システムは設計通りに動作しており、データ取得と保存は正確</td>
                        </tr>
                        <tr>
                            <td>データ整合性</td>
                            <td><span class="badge badge-normal">正常</span></td>
                            <td>データベースのレコードは一貫性を保っている</td>
                        </tr>
                        <tr>
                            <td>ユーザー体験</td>
                            <td><span class="badge badge-issue">要改善</span></td>
                            <td>表示が誤解を招き、ユーザーが混乱する可能性</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="subsection-title">推奨対応</h3>
                <div class="action-item">
                    <div class="action-number">1.</div>
                    <div>
                        <strong>UIの表示を改善して明確化</strong>
                        <p style="margin-top: 5px;">変更例：「JVN iPediaから取得: 633件」→「<strong>今回の取得: 633件 / データベース合計: 1,327件</strong>」</p>
                        <p style="margin-top: 5px;">または、2つのメトリックカードに分けて表示することで視覚的に区別する</p>
                    </div>
                </div>
            </div>

            <!-- 問題② データベースカラムと日付の説明 -->
            <div class="section">
                <h2 class="section-title">🗄️ 問題② データベースカラムと日付の説明</h2>

                <div class="warning-box">
                    <h3 style="margin-bottom: 10px;"><strong>報告内容</strong></h3>
                    <ol>
                        <li>PGAdminに表示される12カラムの意味が不明</li>
                        <li>JVN iPedia公式サイトと日付が異なるケースがある</li>
                    </ol>
                </div>

                <h3 class="subsection-title">調査結果 (1): データベース12カラムの詳細説明</h3>
                <div class="file-path">
                    <strong>調査ファイル：</strong> src/models/vulnerability.py
                </div>

                <table>
                    <thead>
                        <tr>
                            <th style="width: 200px;">カラム名</th>
                            <th style="width: 150px;">データ型</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>cve_id</code></td>
                            <td>String (20文字)</td>
                            <td><strong>主キー。</strong> CVE識別子（例: CVE-2024-0001）</td>
                        </tr>
                        <tr>
                            <td><code>title</code></td>
                            <td>String (500文字)</td>
                            <td>脆弱性のタイトル（概要説明）</td>
                        </tr>
                        <tr>
                            <td><code>description</code></td>
                            <td>Text</td>
                            <td>脆弱性の詳細説明（長文対応）</td>
                        </tr>
                        <tr>
                            <td><code>cvss_score</code></td>
                            <td>Float</td>
                            <td>CVSSベーススコア（0.0-10.0）。脆弱性の深刻度を数値化</td>
                        </tr>
                        <tr>
                            <td><code>severity</code></td>
                            <td>String (20文字)</td>
                            <td>深刻度レベル（Critical/High/Medium/Low）</td>
                        </tr>
                        <tr>
                            <td><code>published_date</code></td>
                            <td>DateTime (timezone付)</td>
                            <td>JVN iPediaでの公開日（<code>dc:date</code>から取得）</td>
                        </tr>
                        <tr>
                            <td><code>modified_date</code></td>
                            <td>DateTime (timezone付)</td>
                            <td>JVN iPediaでの最終更新日（<code>dcterms:modified</code>から取得）</td>
                        </tr>
                        <tr>
                            <td><code>affected_products</code></td>
                            <td>JSON</td>
                            <td>影響を受ける製品情報（配列形式）</td>
                        </tr>
                        <tr>
                            <td><code>vendor_info</code></td>
                            <td>JSON</td>
                            <td>ベンダー情報（ベンダー名、製品名など）</td>
                        </tr>
                        <tr>
                            <td><code>references</code></td>
                            <td>JSON</td>
                            <td>参照リンク（JVN iPedia、NVD、CWEなどへのURL）</td>
                        </tr>
                        <tr>
                            <td><code>created_at</code></td>
                            <td>DateTime (timezone付)</td>
                            <td><strong>データベースレコード</strong>の作成タイムスタンプ（自動生成）</td>
                        </tr>
                        <tr>
                            <td><code>updated_at</code></td>
                            <td>DateTime (timezone付)</td>
                            <td><strong>データベースレコード</strong>の最終更新タイムスタンプ（自動更新）</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">重要な区別</h4>
                    <ul>
                        <li><strong>published_date / modified_date：</strong> 脆弱性情報自体の公開日・更新日（JVN iPediaから取得）</li>
                        <li><strong>created_at / updated_at：</strong> データベースにレコードが登録・更新された日時（システムが自動生成）</li>
                    </ul>
                </div>

                <h3 class="subsection-title">調査結果 (2): 日付の不一致について</h3>
                <div class="file-path">
                    <strong>調査ファイル：</strong> src/fetchers/jvn_fetcher.py (529行目)
                </div>

                <div class="problem-box">
                    <p><span class="badge badge-issue">技術的問題</span> <strong>タイムゾーン処理の不備</strong></p>
                    <p style="margin-top: 10px;"><strong>問題の詳細：</strong></p>
                    <ol>
                        <li>JVN iPediaのデータは<strong>日本時間（+09:00）</strong>で提供される</li>
                        <li>コード内で <code>dt.replace(tzinfo=None)</code> により、タイムゾーン情報を削除している</li>
                        <li>Naive datetime（タイムゾーン情報なし）として保存されるため、表示時にタイムゾーンの解釈が不正確になる</li>
                        <li>結果として、日付が<strong>9時間前後ズレて表示</strong>される可能性がある</li>
                    </ol>
                </div>

                <h3 class="subsection-title">影響評価</h3>
                <table>
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>評価</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>データ取得</td>
                            <td><span class="badge badge-normal">正常</span></td>
                            <td>JVN iPediaからのデータ取得自体は問題なく動作</td>
                        </tr>
                        <tr>
                            <td>日付の正確性</td>
                            <td><span class="badge badge-issue">要修正</span></td>
                            <td>タイムゾーン処理により、日付表示に最大9時間のズレが発生</td>
                        </tr>
                        <tr>
                            <td>ドキュメント</td>
                            <td><span class="badge badge-issue">不足</span></td>
                            <td>データベースカラムの説明がユーザー向けに提供されていない</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="subsection-title">推奨対応</h3>
                <div class="action-item">
                    <div class="action-number">1.</div>
                    <div>
                        <strong>タイムゾーン処理の修正</strong>
                        <p style="margin-top: 5px;">以下のいずれかの方法でタイムゾーン情報を保持：</p>
                        <ul>
                            <li>日本時間（JST）として明示的に扱う</li>
                            <li>UTCに変換してから保存し、表示時に適切なタイムゾーンで表示</li>
                        </ul>
                    </div>
                </div>
                <div class="action-item">
                    <div class="action-number">2.</div>
                    <div>
                        <strong>ドキュメントの整備</strong>
                        <p style="margin-top: 5px;">データベーススキーマのドキュメントを作成し、各カラムの意味と用途を明確に説明</p>
                    </div>
                </div>
            </div>

            <!-- 問題③ GitHub Actionsワークフローの説明 -->
            <div class="section">
                <h2 class="section-title">⚙️ 問題③ GitHub Actionsワークフローの説明</h2>

                <div class="warning-box">
                    <h3 style="margin-bottom: 10px;"><strong>報告内容</strong></h3>
                    <p>GitHub Actionsの「CI」と「Daily Vulnerability Fetch」が何をしているのか分からない。これらのワークフローの目的と動作を知りたい。</p>
                </div>

                <h3 class="subsection-title">ワークフロー (1): CIワークフロー</h3>
                <div class="file-path">
                    <strong>調査ファイル：</strong> .github/workflows/ci.yml
                </div>

                <div class="info-box">
                    <h4 style="margin-bottom: 10px;">概要</h4>
                    <p><strong>トリガー：</strong> mainブランチへのpushまたはPull Request作成時に自動実行</p>
                    <p><strong>目的：</strong> コード品質の自動チェック（継続的インテグレーション）</p>
                </div>

                <h4 style="margin-top: 20px; margin-bottom: 10px;">実行内容（8ステップ）</h4>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30px;">順序</th>
                            <th style="width: 250px;">ステップ名</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><strong>Syntax check</strong></td>
                            <td>Pythonの構文エラーチェック（コンパイルエラーの検出）</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><strong>Type check</strong></td>
                            <td>mypyによる型チェック（型アノテーションの整合性確認）</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><strong>Lint with complexity check</strong></td>
                            <td>flake8による品質チェック（複雑度上限10、行長120文字）</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><strong>Format check (black)</strong></td>
                            <td>コードフォーマットチェック（blackスタイルガイド準拠確認）</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><strong>Import sort check (isort)</strong></td>
                            <td>import文の整列チェック（アルファベット順、標準ライブラリ優先）</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td><strong>Set up database</strong></td>
                            <td>PostgreSQL 15サービスを起動し、テスト用テーブルを作成</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td><strong>Test with coverage</strong></td>
                            <td>pytest実行、カバレッジ77%確認（e2eテストは除外）</td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td><strong>Upload coverage</strong></td>
                            <td>カバレッジレポートをアーティファクトとしてアップロード</td>
                        </tr>
                    </tbody>
                </table>

                <div class="success-box" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">成功の意味</h4>
                    <p>CIワークフローが成功した場合、以下のことが保証されます：</p>
                    <ul>
                        <li>コードに構文エラーがない</li>
                        <li>型アノテーションが正しく使われている</li>
                        <li>コードの複雑度が基準以下（保守性が高い）</li>
                        <li>コードスタイルが統一されている</li>
                        <li>全てのテストがパス（77%以上のカバレッジ）</li>
                        <li>本番環境にデプロイ可能な品質である</li>
                    </ul>
                </div>

                <h3 class="subsection-title">ワークフロー (2): Daily Vulnerability Fetchワークフロー</h3>
                <div class="file-path">
                    <strong>調査ファイル：</strong> .github/workflows/daily_fetch.yml
                </div>

                <div class="info-box">
                    <h4 style="margin-bottom: 10px;">概要</h4>
                    <p><strong>トリガー：</strong></p>
                    <ul>
                        <li><strong>自動：</strong> 毎日午前3時（日本時間）にcronで実行（UTC 18:00）</li>
                        <li><strong>手動：</strong> workflow_dispatchで手動実行可能（差分取得 or 全件取得を選択可能）</li>
                    </ul>
                    <p><strong>目的：</strong> JVN iPediaから最新の脆弱性情報を自動取得</p>
                </div>

                <h4 style="margin-top: 20px; margin-bottom: 10px;">実行内容</h4>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30px;">順序</th>
                            <th style="width: 250px;">ステップ名</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><strong>Setup Python 3.11</strong></td>
                            <td>Python 3.11環境をセットアップ</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><strong>Install dependencies</strong></td>
                            <td>依存パッケージ（FastAPI、SQLAlchemy、httpxなど）をインストール</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><strong>Run fetch script</strong></td>
                            <td><code>scripts/fetch_vulnerabilities.py</code>を実行<br>
                            - <strong>差分取得モード：</strong> 新規・更新データのみ取得（デフォルト）<br>
                            - <strong>全件取得モード：</strong> 過去3年間の全データを取得</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><strong>Save to database</strong></td>
                            <td>取得したデータをNeon PostgreSQLに保存</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><strong>Success notification</strong></td>
                            <td>成功時に成功メッセージを出力</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td><strong>Failure notification</strong></td>
                            <td>失敗時にGitHub Issueを自動作成してエラーを通知</td>
                        </tr>
                    </tbody>
                </table>

                <div class="success-box" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">成功の意味</h4>
                    <p>Daily Vulnerability Fetchワークフローが成功した場合、以下のことが保証されます：</p>
                    <ul>
                        <li>JVN iPedia APIへの接続が成功</li>
                        <li>脆弱性データの取得が完了（新規または全件）</li>
                        <li>データベースへの保存が成功</li>
                        <li>データベースが最新状態に更新された</li>
                        <li>次回の業務開始時には最新の脆弱性情報が利用可能</li>
                    </ul>
                </div>

                <h3 class="subsection-title">影響評価</h3>
                <table>
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>評価</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>CI/CD稼働状況</td>
                            <td><span class="badge badge-normal">正常</span></td>
                            <td>両ワークフローとも正常に動作中</td>
                        </tr>
                        <tr>
                            <td>コード品質</td>
                            <td><span class="badge badge-normal">良好</span></td>
                            <td>CIチェックが全てパス（カバレッジ77%）</td>
                        </tr>
                        <tr>
                            <td>データ取得</td>
                            <td><span class="badge badge-normal">正常</span></td>
                            <td>定期的にJVN iPediaから最新データを取得中</td>
                        </tr>
                        <tr>
                            <td>ドキュメント</td>
                            <td><span class="badge badge-issue">不足</span></td>
                            <td>ワークフローの目的と動作がユーザー向けに説明されていない</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="subsection-title">推奨対応</h3>
                <div class="action-item">
                    <div class="action-number">1.</div>
                    <div>
                        <strong>ユーザー向けドキュメントの整備</strong>
                        <p style="margin-top: 5px;">README.mdまたは専用ドキュメントに以下を追加：</p>
                        <ul>
                            <li>各ワークフローの目的と実行タイミング</li>
                            <li>成功/失敗時の意味と対応方法</li>
                            <li>手動実行の方法（Daily Fetchのworkflow_dispatch）</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- まとめ -->
            <div class="section">
                <h2 class="section-title">📊 まとめ</h2>

                <h3 class="subsection-title">調査結果サマリー</h3>
                <table>
                    <thead>
                        <tr>
                            <th>問題</th>
                            <th>種類</th>
                            <th>重要度</th>
                            <th>ステータス</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>問題① 取得件数表示の誤解</td>
                            <td>ユーザーエクスペリエンス</td>
                            <td><span class="badge badge-issue">中</span></td>
                            <td>UI改善推奨</td>
                        </tr>
                        <tr>
                            <td>問題② タイムゾーン処理の問題</td>
                            <td>技術的問題</td>
                            <td><span class="badge badge-issue">中</span></td>
                            <td>修正推奨</td>
                        </tr>
                        <tr>
                            <td>問題② データベースカラムの説明不足</td>
                            <td>ドキュメント</td>
                            <td><span class="badge badge-issue">低</span></td>
                            <td>ドキュメント追加推奨</td>
                        </tr>
                        <tr>
                            <td>問題③ GitHub Actionsの説明不足</td>
                            <td>ドキュメント</td>
                            <td><span class="badge badge-issue">低</span></td>
                            <td>ドキュメント追加推奨</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="subsection-title">システム正常性評価</h3>
                <div class="success-box">
                    <h4 style="margin-bottom: 10px;">総合評価: <span class="highlight">良好</span></h4>
                    <ul>
                        <li><strong>機能的正常性：</strong> 全ての機能が設計通りに動作中</li>
                        <li><strong>データ整合性：</strong> データベースのレコードは一貫性を保っている</li>
                        <li><strong>CI/CD環境：</strong> GitHub Actionsは正常に稼働中</li>
                        <li><strong>コード品質：</strong> 全ての品質チェックがパス（カバレッジ77%）</li>
                        <li><strong>データ取得：</strong> JVN iPediaから定期的に最新データを取得中</li>
                    </ul>
                </div>

                <h3 class="subsection-title">次のアクション</h3>
                <div class="action-item">
                    <div class="action-number">1.</div>
                    <div>
                        <strong>UIの表示改善（問題①）</strong>
                        <p style="margin-top: 5px;">優先度: <span class="badge badge-issue">中</span></p>
                        <p>「取得件数」を「今回の取得: XXX件 / データベース合計: XXX件」に変更</p>
                    </div>
                </div>
                <div class="action-item">
                    <div class="action-number">2.</div>
                    <div>
                        <strong>タイムゾーン処理の修正（問題②）</strong>
                        <p style="margin-top: 5px;">優先度: <span class="badge badge-issue">中</span></p>
                        <p>日本時間として明示的に扱うか、UTCに変換して保存</p>
                    </div>
                </div>
                <div class="action-item">
                    <div class="action-number">3.</div>
                    <div>
                        <strong>ユーザー向けドキュメントの整備（問題②、問題③）</strong>
                        <p style="margin-top: 5px;">優先度: <span class="badge badge-issue">低</span></p>
                        <p>データベーススキーマとGitHub Actionsワークフローの説明を追加</p>
                    </div>
                </div>
            </div>

            <!-- 調査ファイル一覧 -->
            <div class="section">
                <h2 class="section-title">📁 調査ファイル一覧</h2>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 50px;">No.</th>
                            <th>ファイルパス</th>
                            <th>調査内容</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><code>src/api/vulnerabilities.py</code></td>
                            <td>取得件数表示のロジック確認（225-226行目）</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><code>src/models/vulnerability.py</code></td>
                            <td>データベース12カラムの定義確認</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><code>src/fetchers/jvn_fetcher.py</code></td>
                            <td>タイムゾーン処理の確認（529行目）</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><code>.github/workflows/ci.yml</code></td>
                            <td>CIワークフローの実行内容確認</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><code>.github/workflows/daily_fetch.yml</code></td>
                            <td>Daily Vulnerability Fetchワークフローの実行内容確認</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p><strong>作成者:</strong> システム管理チーム</p>
            <p><strong>作成日:</strong> 2026年1月14日</p>
            <p><strong>プロジェクト:</strong> 脆弱性管理システム</p>
            <p style="margin-top: 15px; font-size: 0.9em;">この報告書は、システムの動作確認と問題調査の結果をまとめたものです。<br>システムは正常に動作しており、発見された問題は主にUIとドキュメント不足に起因します。</p>
        </div>
    </div>
</body>
</html>
