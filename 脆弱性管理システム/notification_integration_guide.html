<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€šçŸ¥é€£æºã‚¬ã‚¤ãƒ‰ï¼ˆãƒ¡ãƒ¼ãƒ«/Teams/Discordï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: #f6f8fa;
            color: #24292f;
            line-height: 1.6;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #24292f;
            margin-bottom: 10px;
            font-size: 28px;
        }
        .subtitle {
            text-align: center;
            color: #57606a;
            margin-bottom: 30px;
        }
        
        .section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #24292f;
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #5865F2;
        }
        .section h2.teams { border-bottom-color: #6264A7; }
        .section h2.email { border-bottom-color: #0969da; }
        .section h2.discord { border-bottom-color: #5865F2; }
        .section h2.design { border-bottom-color: #2da44e; }
        .section h3 {
            color: #24292f;
            font-size: 16px;
            margin: 24px 0 12px;
        }
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ« */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #d0d7de;
        }
        th {
            background: #f6f8fa;
            font-weight: 600;
        }
        
        /* å›³è§£ */
        .diagram {
            background: #f6f8fa;
            border-radius: 8px;
            padding: 24px;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        /* ãƒã‚¤ãƒ³ãƒˆãƒœãƒƒã‚¯ã‚¹ */
        .point-box {
            background: #ddf4ff;
            border: 1px solid #54aeff;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .point-box h4 {
            color: #0969da;
            margin-bottom: 8px;
        }
        .point-box ul {
            margin-left: 20px;
        }
        .point-box li {
            margin: 4px 0;
        }
        
        .callout {
            background: #fff8c5;
            border: 1px solid #d4a72c;
            border-radius: 8px;
            padding: 12px 16px;
            margin: 12px 0;
            font-size: 14px;
        }
        .callout::before {
            content: "ğŸ’¡";
            margin-right: 8px;
        }
        
        .recommend-box {
            background: #dafbe1;
            border: 1px solid #2da44e;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .recommend-box h4 {
            color: #1a7f37;
            margin-bottom: 8px;
        }
        
        .warning-box {
            background: #ffebe9;
            border: 1px solid #ff8182;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .warning-box h4 {
            color: #cf222e;
            margin-bottom: 8px;
        }
        
        /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
        .code-block {
            background: #24292f;
            color: #e6edf3;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 16px 0;
            line-height: 1.5;
        }
        .code-block .comment {
            color: #8b949e;
        }
        .code-block .keyword {
            color: #ff7b72;
        }
        .code-block .string {
            color: #a5d6ff;
        }
        .code-block .function {
            color: #d2a8ff;
        }
        .code-block .number {
            color: #79c0ff;
        }
        .code-block .class {
            color: #7ee787;
        }
        
        code {
            background: #f6f8fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
        }
        
        /* æ‰‹é †ãƒªã‚¹ãƒˆ */
        .steps {
            margin: 20px 0;
        }
        .step {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            padding: 16px;
            background: #f6f8fa;
            border-radius: 8px;
            border-left: 4px solid #0969da;
        }
        .step.teams { border-left-color: #6264A7; }
        .step.discord { border-left-color: #5865F2; }
        .step-number {
            width: 32px;
            height: 32px;
            background: #0969da;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        .step.teams .step-number { background: #6264A7; }
        .step.discord .step-number { background: #5865F2; }
        .step-content h4 {
            margin-bottom: 4px;
        }
        .step-content p {
            font-size: 14px;
            color: #57606a;
        }
        
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
        .message-preview {
            background: white;
            border: 1px solid #d0d7de;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        
        /* Teamsé¢¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .teams-message {
            font-family: 'Segoe UI', sans-serif;
        }
        .teams-message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .teams-bot-icon {
            width: 32px;
            height: 32px;
            background: #6264A7;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }
        .teams-bot-name {
            font-weight: 600;
            color: #242424;
        }
        .teams-card {
            border-left: 4px solid #cf222e;
            background: #f5f5f5;
            padding: 12px;
            border-radius: 4px;
        }
        .teams-card.warning { border-left-color: #bf8700; }
        .teams-card.info { border-left-color: #0969da; }
        .teams-card-title {
            font-weight: 600;
            font-size: 15px;
            margin-bottom: 8px;
        }
        .teams-field {
            display: inline-block;
            margin-right: 24px;
            margin-top: 8px;
        }
        .teams-field-title {
            font-size: 12px;
            color: #616161;
            font-weight: 600;
        }
        .teams-field-value {
            font-size: 14px;
        }
        
        /* Discordé¢¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .discord-message {
            background: #313338;
            color: #dbdee1;
            border-radius: 8px;
            padding: 16px;
            font-family: 'gg sans', 'Noto Sans', sans-serif;
        }
        .discord-message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .discord-bot-icon {
            width: 40px;
            height: 40px;
            background: #5865F2;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }
        .discord-bot-name {
            font-weight: 600;
            color: #f2f3f5;
        }
        .discord-bot-badge {
            background: #5865F2;
            color: white;
            font-size: 10px;
            padding: 2px 4px;
            border-radius: 3px;
            margin-left: 4px;
        }
        .discord-timestamp {
            font-size: 12px;
            color: #949ba4;
            margin-left: 8px;
        }
        .discord-embed {
            border-left: 4px solid #ed4245;
            background: #2b2d31;
            padding: 12px;
            border-radius: 4px;
            margin-top: 8px;
            max-width: 500px;
        }
        .discord-embed.warning { border-left-color: #fee75c; }
        .discord-embed.info { border-left-color: #5865F2; }
        .discord-embed-title {
            font-weight: 600;
            font-size: 15px;
            color: #00aff4;
            margin-bottom: 8px;
        }
        .discord-embed-field {
            display: inline-block;
            width: 45%;
            margin-top: 8px;
            vertical-align: top;
        }
        .discord-embed-field-name {
            font-size: 12px;
            color: #949ba4;
            font-weight: 600;
        }
        .discord-embed-field-value {
            font-size: 14px;
            color: #dbdee1;
        }
        
        /* ãƒ¡ãƒ¼ãƒ«é¢¨ */
        .email-preview {
            background: white;
            border: 1px solid #d0d7de;
            border-radius: 8px;
            overflow: hidden;
            margin: 16px 0;
        }
        .email-header {
            background: #f6f8fa;
            padding: 12px 16px;
            border-bottom: 1px solid #d0d7de;
        }
        .email-header-row {
            display: flex;
            font-size: 13px;
            margin: 4px 0;
        }
        .email-header-label {
            width: 60px;
            color: #57606a;
        }
        .email-header-value {
            font-weight: 500;
        }
        .email-body {
            padding: 20px;
        }
        .email-body h2 {
            border: none;
            font-size: 18px;
            margin-bottom: 16px;
            padding: 0;
        }
        
        /* æ¯”è¼ƒã‚«ãƒ¼ãƒ‰ */
        .compare-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 20px 0;
        }
        .compare-card {
            border: 2px solid #d0d7de;
            border-radius: 8px;
            overflow: hidden;
        }
        .compare-card-header {
            padding: 12px 16px;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        .compare-card-header.teams { background: #6264A7; }
        .compare-card-header.discord { background: #5865F2; }
        .compare-card-header.email { background: #0969da; }
        .compare-card-body {
            padding: 16px;
        }
        .compare-card-body ul {
            margin-left: 20px;
            font-size: 14px;
        }
        .compare-card-body li {
            margin: 6px 0;
        }
        
        /* é€šçŸ¥ãƒ•ãƒ­ãƒ¼å›³ */
        .notification-flow {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: #f6f8fa;
            border-radius: 8px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .flow-box {
            padding: 12px 20px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
        }
        .flow-box.source { background: #fff8c5; border: 2px solid #d4a72c; }
        .flow-box.service { background: #fbefff; border: 2px solid #8250df; }
        .flow-box.teams { background: #6264A7; color: white; }
        .flow-box.discord { background: #5865F2; color: white; }
        .flow-box.email { background: #0969da; color: white; }
        .flow-arrow {
            font-size: 24px;
            color: #8c959f;
        }

        @media (max-width: 768px) {
            .compare-cards {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            body { background: white; }
            .section { box-shadow: none; border: 1px solid #ddd; }
            .discord-message { background: #f0f0f0; color: #333; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”” é€šçŸ¥é€£æºã‚¬ã‚¤ãƒ‰</h1>
        <p class="subtitle">ãƒ¡ãƒ¼ãƒ« / Microsoft Teams / Discord ã®APIé€£æºå®Ÿè£…</p>

        <!-- æ¦‚è¦ãƒ»æ¯”è¼ƒ -->
        <div class="section">
            <h2>ğŸ“‹ 3ã¤ã®é€šçŸ¥ãƒãƒ£ãƒãƒ«ã®æ¯”è¼ƒ</h2>
            
            <div class="compare-cards">
                <div class="compare-card">
                    <div class="compare-card-header teams">Microsoft Teams</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>âœ… Incoming Webhookå¯¾å¿œ</li>
                            <li>âœ… ä¼æ¥­åˆ©ç”¨ã«é©ã—ã¦ã„ã‚‹</li>
                            <li>âœ… Adaptive Cardså¯¾å¿œ</li>
                            <li>âœ… Microsoft 365é€£æº</li>
                            <li>âš¡ è¨­å®šï¼šç°¡å˜</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #6264A7; font-weight: 600;">
                            ãƒ“ã‚¸ãƒã‚¹åˆ©ç”¨ã«æ¨å¥¨
                        </p>
                    </div>
                </div>
                
                <div class="compare-card">
                    <div class="compare-card-header discord">Discord</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>âœ… Webhookå¯¾å¿œï¼ˆæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ï¼‰</li>
                            <li>âœ… ãƒªãƒƒãƒãªåŸ‹ã‚è¾¼ã¿è¡¨ç¤º</li>
                            <li>âœ… ç„¡æ–™ã§åˆ©ç”¨å¯èƒ½</li>
                            <li>âœ… æŠ€è¡“ãƒãƒ¼ãƒ å‘ã‘</li>
                            <li>âš¡ è¨­å®šï¼šéå¸¸ã«ç°¡å˜</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #5865F2; font-weight: 600;">
                            é–‹ç™ºãƒãƒ¼ãƒ å‘ã‘ã«æ¨å¥¨
                        </p>
                    </div>
                </div>
                
                <div class="compare-card">
                    <div class="compare-card-header email">ãƒ¡ãƒ¼ãƒ«</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>âœ… å…¨å“¡ã«ç¢ºå®Ÿã«å±Šã</li>
                            <li>âœ… æ­£å¼ãªè¨˜éŒ²ã¨ã—ã¦æ®‹ã‚‹</li>
                            <li>âœ… PDFæ·»ä»˜å¯èƒ½</li>
                            <li>âœ… ç›£æŸ»è¨¼è·¡ã«åˆ©ç”¨</li>
                            <li>âš¡ SMTP or AWS SES</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #0969da; font-weight: 600;">
                            å…¬å¼é€šçŸ¥ãƒ»ãƒ¬ãƒãƒ¼ãƒˆã«æ¨å¥¨
                        </p>
                    </div>
                </div>
            </div>
            
            <h3>é€šçŸ¥ãƒ•ãƒ­ãƒ¼</h3>
            <div class="notification-flow">
                <div class="flow-box source">ãƒãƒƒãƒãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³<br><span style="font-size: 12px; font-weight: normal;">æ–°è¦è„†å¼±æ€§æ¤œå‡º</span></div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-box service">é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹<br><span style="font-size: 12px; font-weight: normal;">æ¡ä»¶åˆ¤å®šãƒ»æŒ¯ã‚Šåˆ†ã‘</span></div>
                <div class="flow-arrow">â†’</div>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <div class="flow-box teams">Teams</div>
                    <div class="flow-box discord">Discord</div>
                    <div class="flow-box email">ãƒ¡ãƒ¼ãƒ«</div>
                </div>
            </div>
            
            <h3>ç”¨é€”åˆ¥ã®æ¨å¥¨</h3>
            <table>
                <tr>
                    <th>é€šçŸ¥ã‚¿ã‚¤ãƒ—</th>
                    <th>æ¨å¥¨ãƒãƒ£ãƒãƒ«</th>
                    <th>ç†ç”±</th>
                </tr>
                <tr>
                    <td><strong>å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆCriticalï¼‰</strong></td>
                    <td>Teams + ãƒ¡ãƒ¼ãƒ«</td>
                    <td>ç¢ºå®Ÿã«å±Šãã€è¦‹é€ƒã—é˜²æ­¢</td>
                </tr>
                <tr>
                    <td><strong>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</strong></td>
                    <td>Teams or Discord</td>
                    <td>ãƒãƒ£ãƒƒãƒˆã§ç´ æ—©ãç¢ºèª</td>
                </tr>
                <tr>
                    <td><strong>é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</strong></td>
                    <td>ãƒ¡ãƒ¼ãƒ«ï¼ˆPDFæ·»ä»˜ï¼‰</td>
                    <td>æ­£å¼è¨˜éŒ²ã€ç›£æŸ»å¯¾å¿œ</td>
                </tr>
                <tr>
                    <td><strong>é–‹ç™ºãƒãƒ¼ãƒ å‘ã‘</strong></td>
                    <td>Discord</td>
                    <td>æŠ€è¡“è€…ã«é¦´æŸ“ã¿ã‚„ã™ã„</td>
                </tr>
            </table>
        </div>

        <!-- Microsoft Teams -->
        <div class="section">
            <h2 class="teams">ğŸ’¼ Microsoft Teams é€£æº</h2>
            
            <p style="margin-bottom: 16px;">
                Teamsã¯Slackã¨åŒæ§˜ã«<strong>Incoming Webhook</strong>ã§ã‚·ãƒ³ãƒ—ãƒ«ã«é€£æºã§ãã¾ã™ã€‚
            </p>
            
            <h3>Webhookè¨­å®šæ‰‹é †</h3>
            <div class="steps">
                <div class="step teams">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>ãƒãƒ£ãƒãƒ«ã‚’é¸æŠ</h4>
                        <p>é€šçŸ¥ã‚’é€ä¿¡ã—ãŸã„ãƒãƒ£ãƒãƒ«ã®ã€Œâ€¦ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯</p>
                    </div>
                </div>
                <div class="step teams">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>ã‚³ãƒã‚¯ã‚¿ã‚’è¿½åŠ </h4>
                        <p>ã€Œã‚³ãƒã‚¯ã‚¿ã€â†’ã€ŒIncoming Webhookã€ã‚’æ¤œç´¢ â†’ã€Œæ§‹æˆã€</p>
                    </div>
                </div>
                <div class="step teams">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>Webhookã‚’ä½œæˆ</h4>
                        <p>åå‰ï¼ˆä¾‹ï¼šè„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆï¼‰ã¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’è¨­å®š â†’ã€Œä½œæˆã€</p>
                    </div>
                </div>
                <div class="step teams">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>URLã‚’ã‚³ãƒ”ãƒ¼</h4>
                        <p>ç”Ÿæˆã•ã‚ŒãŸWebhook URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜</p>
                    </div>
                </div>
            </div>
            
            <div class="callout">
                Teamsç®¡ç†è€…ãŒWebhookã‚’ç„¡åŠ¹åŒ–ã—ã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚è¨­å®šã§ããªã„å ´åˆã¯ITéƒ¨é–€ã«ç¢ºèªã—ã¦ãã ã•ã„ã€‚
            </div>
            
            <h3>åŸºæœ¬çš„ãªé€šçŸ¥ã‚³ãƒ¼ãƒ‰</h3>
            <div class="code-block">
<span class="comment"># teams_notifier.py</span>
<span class="keyword">import</span> requests
<span class="keyword">import</span> os
<span class="keyword">from</span> typing <span class="keyword">import</span> Dict, List

<span class="keyword">class</span> <span class="class">TeamsNotifier</span>:
    <span class="string">"""Microsoft Teamsé€šçŸ¥ã‚¯ãƒ©ã‚¹"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, webhook_url: str = <span class="keyword">None</span>):
        self.webhook_url = webhook_url <span class="keyword">or</span> os.getenv(<span class="string">"TEAMS_WEBHOOK_URL"</span>)
    
    <span class="keyword">def</span> <span class="function">send_message</span>(self, title: str, text: str, color: str = <span class="string">"0078D7"</span>) -> bool:
        <span class="string">"""ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡"""</span>
        
        payload = {
            <span class="string">"@type"</span>: <span class="string">"MessageCard"</span>,
            <span class="string">"@context"</span>: <span class="string">"http://schema.org/extensions"</span>,
            <span class="string">"themeColor"</span>: color,
            <span class="string">"summary"</span>: title,
            <span class="string">"sections"</span>: [{
                <span class="string">"activityTitle"</span>: title,
                <span class="string">"text"</span>: text
            }]
        }
        
        response = requests.post(self.webhook_url, json=payload)
        <span class="keyword">return</span> response.status_code == <span class="number">200</span>
    
    <span class="keyword">def</span> <span class="function">send_vulnerability_alert</span>(self, vuln: Dict, asset: Dict, priority: Dict) -> bool:
        <span class="string">"""è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é€ä¿¡"""</span>
        
        <span class="comment"># å„ªå…ˆåº¦ã«å¿œã˜ãŸè‰²</span>
        colors = {
            <span class="string">"Immediate"</span>: <span class="string">"FF0000"</span>,    <span class="comment"># èµ¤</span>
            <span class="string">"Out-of-Cycle"</span>: <span class="string">"FFA500"</span>, <span class="comment"># ã‚ªãƒ¬ãƒ³ã‚¸</span>
            <span class="string">"Scheduled"</span>: <span class="string">"0078D7"</span>,    <span class="comment"># é’</span>
            <span class="string">"Defer"</span>: <span class="string">"808080"</span>         <span class="comment"># ã‚°ãƒ¬ãƒ¼</span>
        }
        color = colors.get(priority[<span class="string">"action"</span>], <span class="string">"0078D7"</span>)
        
        payload = {
            <span class="string">"@type"</span>: <span class="string">"MessageCard"</span>,
            <span class="string">"@context"</span>: <span class="string">"http://schema.org/extensions"</span>,
            <span class="string">"themeColor"</span>: color,
            <span class="string">"summary"</span>: f<span class="string">"ğŸš¨ æ–°ã—ã„è„†å¼±æ€§: {vuln['cve_id']}"</span>,
            <span class="string">"sections"</span>: [{
                <span class="string">"activityTitle"</span>: <span class="string">"ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ"</span>,
                <span class="string">"facts"</span>: [
                    {<span class="string">"name"</span>: <span class="string">"CVE ID"</span>, <span class="string">"value"</span>: vuln[<span class="string">"cve_id"</span>]},
                    {<span class="string">"name"</span>: <span class="string">"CVSS"</span>, <span class="string">"value"</span>: f<span class="string">"{vuln['cvss_score']} ({vuln['severity']})"</span>},
                    {<span class="string">"name"</span>: <span class="string">"å¯¾è±¡è³‡ç”£"</span>, <span class="string">"value"</span>: asset[<span class="string">"hostname"</span>]},
                    {<span class="string">"name"</span>: <span class="string">"ç’°å¢ƒ"</span>, <span class="string">"value"</span>: asset[<span class="string">"environment"</span>]},
                    {<span class="string">"name"</span>: <span class="string">"å„ªå…ˆåº¦"</span>, <span class="string">"value"</span>: priority[<span class="string">"action"</span>]}
                ],
                <span class="string">"text"</span>: vuln[<span class="string">"title"</span>]
            }],
            <span class="string">"potentialAction"</span>: [{
                <span class="string">"@type"</span>: <span class="string">"OpenUri"</span>,
                <span class="string">"name"</span>: <span class="string">"NVDã§è©³ç´°ã‚’è¦‹ã‚‹"</span>,
                <span class="string">"targets"</span>: [{
                    <span class="string">"os"</span>: <span class="string">"default"</span>,
                    <span class="string">"uri"</span>: f<span class="string">"https://nvd.nist.gov/vuln/detail/{vuln['cve_id']}"</span>
                }]
            }, {
                <span class="string">"@type"</span>: <span class="string">"OpenUri"</span>,
                <span class="string">"name"</span>: <span class="string">"ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã"</span>,
                <span class="string">"targets"</span>: [{
                    <span class="string">"os"</span>: <span class="string">"default"</span>,
                    <span class="string">"uri"</span>: <span class="string">"https://vuln-dashboard.example.com"</span>
                }]
            }]
        }
        
        response = requests.post(self.webhook_url, json=payload)
        <span class="keyword">return</span> response.status_code == <span class="number">200</span>
            </div>
            
            <h3>Teamsé€šçŸ¥ã®è¡¨ç¤ºã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
            <div class="message-preview teams-message">
                <div class="teams-message-header">
                    <div class="teams-bot-icon">ğŸ›¡ï¸</div>
                    <span class="teams-bot-name">è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
                </div>
                <div class="teams-card">
                    <div class="teams-card-title">ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ</div>
                    <div class="teams-field">
                        <div class="teams-field-title">CVE ID</div>
                        <div class="teams-field-value">CVE-2024-1234</div>
                    </div>
                    <div class="teams-field">
                        <div class="teams-field-title">CVSS</div>
                        <div class="teams-field-value">9.8 (Critical)</div>
                    </div>
                    <div class="teams-field">
                        <div class="teams-field-title">å¯¾è±¡è³‡ç”£</div>
                        <div class="teams-field-value">web-server-01</div>
                    </div>
                    <div class="teams-field">
                        <div class="teams-field-title">ç’°å¢ƒ</div>
                        <div class="teams-field-value">æœ¬ç•ª</div>
                    </div>
                    <div class="teams-field">
                        <div class="teams-field-title">å„ªå…ˆåº¦</div>
                        <div class="teams-field-value" style="color: #cf222e; font-weight: bold;">Immediate</div>
                    </div>
                    <div style="margin-top: 12px; font-size: 14px;">
                        Apache HTTP Server ã«ãŠã‘ã‚‹é‡å¤§ãªè„†å¼±æ€§
                    </div>
                </div>
                <div style="margin-top: 12px;">
                    <button style="background: #6264A7; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 8px; cursor: pointer;">NVDã§è©³ç´°ã‚’è¦‹ã‚‹</button>
                    <button style="background: #6264A7; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã</button>
                </div>
            </div>
            
            <h3>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã®é€ä¿¡</h3>
            <div class="code-block">
<span class="keyword">def</span> <span class="function">send_daily_summary</span>(self, summary: Dict) -> bool:
    <span class="string">"""æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã‚’é€ä¿¡"""</span>
    
    payload = {
        <span class="string">"@type"</span>: <span class="string">"MessageCard"</span>,
        <span class="string">"@context"</span>: <span class="string">"http://schema.org/extensions"</span>,
        <span class="string">"themeColor"</span>: <span class="string">"0078D7"</span>,
        <span class="string">"summary"</span>: <span class="string">"ğŸ“Š è„†å¼±æ€§æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ"</span>,
        <span class="string">"sections"</span>: [{
            <span class="string">"activityTitle"</span>: <span class="string">"ğŸ“Š è„†å¼±æ€§æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ"</span>,
            <span class="string">"facts"</span>: [
                {<span class="string">"name"</span>: <span class="string">"ğŸ†• æ–°è¦æ¤œå‡º"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['new_count']}ä»¶"</span>},
                {<span class="string">"name"</span>: <span class="string">"âœ… è§£æ¶ˆ"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['resolved_count']}ä»¶"</span>},
                {<span class="string">"name"</span>: <span class="string">"ğŸ“‹ æœªå¯¾å¿œ"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['open_count']}ä»¶"</span>},
                {<span class="string">"name"</span>: <span class="string">"ğŸ”´ Critical"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['critical_count']}ä»¶"</span>}
            ]
        }],
        <span class="string">"potentialAction"</span>: [{
            <span class="string">"@type"</span>: <span class="string">"OpenUri"</span>,
            <span class="string">"name"</span>: <span class="string">"ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã"</span>,
            <span class="string">"targets"</span>: [{<span class="string">"os"</span>: <span class="string">"default"</span>, <span class="string">"uri"</span>: <span class="string">"https://vuln-dashboard.example.com"</span>}]
        }]
    }
    
    response = requests.post(self.webhook_url, json=payload)
    <span class="keyword">return</span> response.status_code == <span class="number">200</span>
            </div>
        </div>

        <!-- Discord -->
        <div class="section">
            <h2 class="discord">ğŸ® Discord é€£æº</h2>
            
            <p style="margin-bottom: 16px;">
                Discordã®Webhookã¯<strong>æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«</strong>ã§ã€è¨­å®šã‚‚ç°¡å˜ã§ã™ã€‚
            </p>
            
            <h3>Webhookè¨­å®šæ‰‹é †</h3>
            <div class="steps">
                <div class="step discord">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>ã‚µãƒ¼ãƒãƒ¼è¨­å®šã‚’é–‹ã</h4>
                        <p>ã‚µãƒ¼ãƒãƒ¼åã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ã€Œã‚µãƒ¼ãƒãƒ¼è¨­å®šã€</p>
                    </div>
                </div>
                <div class="step discord">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>é€£æºã‚µãƒ¼ãƒ“ã‚¹ã‚’é¸æŠ</h4>
                        <p>å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€Œé€£æºã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã€</p>
                    </div>
                </div>
                <div class="step discord">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>æ–°ã—ã„ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã‚’ä½œæˆ</h4>
                        <p>ã€Œæ–°ã—ã„ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã€â†’ åå‰ã¨ãƒãƒ£ãƒ³ãƒãƒ«ã‚’è¨­å®š</p>
                    </div>
                </div>
                <div class="step discord">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>URLã‚’ã‚³ãƒ”ãƒ¼</h4>
                        <p>ã€Œã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯URLã‚’ã‚³ãƒ”ãƒ¼ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</p>
                    </div>
                </div>
            </div>
            
            <h3>åŸºæœ¬çš„ãªé€šçŸ¥ã‚³ãƒ¼ãƒ‰</h3>
            <div class="code-block">
<span class="comment"># discord_notifier.py</span>
<span class="keyword">import</span> requests
<span class="keyword">import</span> os
<span class="keyword">from</span> typing <span class="keyword">import</span> Dict, List
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="keyword">class</span> <span class="class">DiscordNotifier</span>:
    <span class="string">"""Discordé€šçŸ¥ã‚¯ãƒ©ã‚¹"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, webhook_url: str = <span class="keyword">None</span>):
        self.webhook_url = webhook_url <span class="keyword">or</span> os.getenv(<span class="string">"DISCORD_WEBHOOK_URL"</span>)
    
    <span class="keyword">def</span> <span class="function">send_message</span>(self, content: str, embeds: List[Dict] = <span class="keyword">None</span>) -> bool:
        <span class="string">"""ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡"""</span>
        
        payload = {<span class="string">"content"</span>: content}
        
        <span class="keyword">if</span> embeds:
            payload[<span class="string">"embeds"</span>] = embeds
        
        response = requests.post(self.webhook_url, json=payload)
        <span class="keyword">return</span> response.status_code == <span class="number">204</span>  <span class="comment"># Discordã¯204ã‚’è¿”ã™</span>
    
    <span class="keyword">def</span> <span class="function">send_vulnerability_alert</span>(self, vuln: Dict, asset: Dict, priority: Dict) -> bool:
        <span class="string">"""è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é€ä¿¡"""</span>
        
        <span class="comment"># å„ªå…ˆåº¦ã«å¿œã˜ãŸè‰²ï¼ˆ10é€²æ•°ï¼‰</span>
        colors = {
            <span class="string">"Immediate"</span>: <span class="number">15548997</span>,   <span class="comment"># èµ¤ (#ED4245)</span>
            <span class="string">"Out-of-Cycle"</span>: <span class="number">16705372</span>, <span class="comment"># ã‚ªãƒ¬ãƒ³ã‚¸ (#FEE75C)</span>
            <span class="string">"Scheduled"</span>: <span class="number">5793266</span>,    <span class="comment"># é’ (#5865F2)</span>
            <span class="string">"Defer"</span>: <span class="number">9807270</span>          <span class="comment"># ã‚°ãƒ¬ãƒ¼ (#959B96)</span>
        }
        color = colors.get(priority[<span class="string">"action"</span>], <span class="number">5793266</span>)
        
        <span class="comment"># ç·Šæ€¥åº¦ã«å¿œã˜ãŸãƒ¡ãƒ³ã‚·ãƒ§ãƒ³</span>
        mention = <span class="string">"@everyone"</span> <span class="keyword">if</span> priority[<span class="string">"action"</span>] == <span class="string">"Immediate"</span> <span class="keyword">else</span> <span class="string">""</span>
        
        embed = {
            <span class="string">"title"</span>: <span class="string">"ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ"</span>,
            <span class="string">"color"</span>: color,
            <span class="string">"fields"</span>: [
                {<span class="string">"name"</span>: <span class="string">"CVE ID"</span>, <span class="string">"value"</span>: vuln[<span class="string">"cve_id"</span>], <span class="string">"inline"</span>: <span class="keyword">True</span>},
                {<span class="string">"name"</span>: <span class="string">"CVSS"</span>, <span class="string">"value"</span>: f<span class="string">"{vuln['cvss_score']} ({vuln['severity']})"</span>, <span class="string">"inline"</span>: <span class="keyword">True</span>},
                {<span class="string">"name"</span>: <span class="string">"å„ªå…ˆåº¦"</span>, <span class="string">"value"</span>: priority[<span class="string">"action"</span>], <span class="string">"inline"</span>: <span class="keyword">True</span>},
                {<span class="string">"name"</span>: <span class="string">"å¯¾è±¡è³‡ç”£"</span>, <span class="string">"value"</span>: asset[<span class="string">"hostname"</span>], <span class="string">"inline"</span>: <span class="keyword">True</span>},
                {<span class="string">"name"</span>: <span class="string">"ç’°å¢ƒ"</span>, <span class="string">"value"</span>: asset[<span class="string">"environment"</span>], <span class="string">"inline"</span>: <span class="keyword">True</span>},
                {<span class="string">"name"</span>: <span class="string">"æ¦‚è¦"</span>, <span class="string">"value"</span>: vuln[<span class="string">"title"</span>], <span class="string">"inline"</span>: <span class="keyword">False</span>}
            ],
            <span class="string">"timestamp"</span>: datetime.utcnow().isoformat(),
            <span class="string">"footer"</span>: {
                <span class="string">"text"</span>: <span class="string">"è„†å¼±æ€§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ "</span>
            },
            <span class="string">"url"</span>: f<span class="string">"https://nvd.nist.gov/vuln/detail/{vuln['cve_id']}"</span>
        }
        
        <span class="keyword">return</span> self.send_message(content=mention, embeds=[embed])
            </div>
            
            <h3>Discordé€šçŸ¥ã®è¡¨ç¤ºã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
            <div class="discord-message">
                <div class="discord-message-header">
                    <div class="discord-bot-icon">ğŸ›¡ï¸</div>
                    <span class="discord-bot-name">è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
                    <span class="discord-bot-badge">BOT</span>
                    <span class="discord-timestamp">ä»Šæ—¥ 10:30</span>
                </div>
                <div class="discord-embed">
                    <div class="discord-embed-title">ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ</div>
                    <div class="discord-embed-field">
                        <div class="discord-embed-field-name">CVE ID</div>
                        <div class="discord-embed-field-value">CVE-2024-1234</div>
                    </div>
                    <div class="discord-embed-field">
                        <div class="discord-embed-field-name">CVSS</div>
                        <div class="discord-embed-field-value">9.8 (Critical)</div>
                    </div>
                    <div class="discord-embed-field">
                        <div class="discord-embed-field-name">å„ªå…ˆåº¦</div>
                        <div class="discord-embed-field-value" style="color: #ed4245;">Immediate</div>
                    </div>
                    <div class="discord-embed-field">
                        <div class="discord-embed-field-name">å¯¾è±¡è³‡ç”£</div>
                        <div class="discord-embed-field-value">web-server-01</div>
                    </div>
                    <div class="discord-embed-field">
                        <div class="discord-embed-field-name">ç’°å¢ƒ</div>
                        <div class="discord-embed-field-value">æœ¬ç•ª</div>
                    </div>
                    <div style="margin-top: 12px;">
                        <div class="discord-embed-field-name">æ¦‚è¦</div>
                        <div class="discord-embed-field-value">Apache HTTP Server ã«ãŠã‘ã‚‹é‡å¤§ãªè„†å¼±æ€§</div>
                    </div>
                    <div style="margin-top: 12px; font-size: 11px; color: #949ba4;">
                        è„†å¼±æ€§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  â€¢ ä»Šæ—¥ 10:30
                    </div>
                </div>
            </div>
            
            <h3>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã®é€ä¿¡</h3>
            <div class="code-block">
<span class="keyword">def</span> <span class="function">send_daily_summary</span>(self, summary: Dict) -> bool:
    <span class="string">"""æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã‚’é€ä¿¡"""</span>
    
    <span class="comment"># çŠ¶æ³ã«å¿œã˜ãŸè‰²</span>
    <span class="keyword">if</span> summary[<span class="string">"critical_count"</span>] > <span class="number">0</span>:
        color = <span class="number">15548997</span>  <span class="comment"># èµ¤</span>
    <span class="keyword">elif</span> summary[<span class="string">"new_count"</span>] > <span class="number">0</span>:
        color = <span class="number">16705372</span>  <span class="comment"># ã‚ªãƒ¬ãƒ³ã‚¸</span>
    <span class="keyword">else</span>:
        color = <span class="number">5763719</span>   <span class="comment"># ç·‘</span>
    
    embed = {
        <span class="string">"title"</span>: <span class="string">"ğŸ“Š è„†å¼±æ€§æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ"</span>,
        <span class="string">"color"</span>: color,
        <span class="string">"fields"</span>: [
            {<span class="string">"name"</span>: <span class="string">"ğŸ†• æ–°è¦æ¤œå‡º"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['new_count']}ä»¶"</span>, <span class="string">"inline"</span>: <span class="keyword">True</span>},
            {<span class="string">"name"</span>: <span class="string">"âœ… è§£æ¶ˆ"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['resolved_count']}ä»¶"</span>, <span class="string">"inline"</span>: <span class="keyword">True</span>},
            {<span class="string">"name"</span>: <span class="string">"ğŸ“‹ æœªå¯¾å¿œ"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['open_count']}ä»¶"</span>, <span class="string">"inline"</span>: <span class="keyword">True</span>},
            {<span class="string">"name"</span>: <span class="string">"ğŸ”´ Critical"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['critical_count']}ä»¶"</span>, <span class="string">"inline"</span>: <span class="keyword">True</span>},
            {<span class="string">"name"</span>: <span class="string">"ğŸŸ  High"</span>, <span class="string">"value"</span>: f<span class="string">"{summary['high_count']}ä»¶"</span>, <span class="string">"inline"</span>: <span class="keyword">True</span>}
        ],
        <span class="string">"timestamp"</span>: datetime.utcnow().isoformat(),
        <span class="string">"footer"</span>: {<span class="string">"text"</span>: <span class="string">"è„†å¼±æ€§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ "</span>}
    }
    
    <span class="keyword">return</span> self.send_message(content=<span class="string">""</span>, embeds=[embed])
            </div>
            
            <div class="point-box">
                <h4>Discordã®ç‰¹å¾´</h4>
                <ul>
                    <li><code>@everyone</code> ã§ãƒãƒ£ãƒ³ãƒãƒ«å…¨å“¡ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¯èƒ½</li>
                    <li><code>@here</code> ã§ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒãƒ¼ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³</li>
                    <li>åŸ‹ã‚è¾¼ã¿ï¼ˆEmbedï¼‰ã§ãƒªãƒƒãƒãªè¡¨ç¤ºãŒå¯èƒ½</li>
                    <li>ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼š5ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/2ç§’ï¼ˆWebhookã‚ãŸã‚Šï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ -->
        <div class="section">
            <h2 class="email">ğŸ“§ ãƒ¡ãƒ¼ãƒ«é€šçŸ¥</h2>
            
            <p style="margin-bottom: 16px;">
                ãƒ¡ãƒ¼ãƒ«ã¯æœ€ã‚‚ç¢ºå®Ÿã«å±Šãé€šçŸ¥æ–¹æ³•ã§ã™ã€‚æ­£å¼ãªãƒ¬ãƒãƒ¼ãƒˆã‚„ç›£æŸ»è¨˜éŒ²ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
            </p>
            
            <h3>å®Ÿè£…æ–¹å¼ã®æ¯”è¼ƒ</h3>
            <table>
                <tr>
                    <th style="width: 20%;">æ–¹å¼</th>
                    <th>ãƒ¡ãƒªãƒƒãƒˆ</th>
                    <th>ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ</th>
                    <th style="width: 20%;">æ¨å¥¨ã‚±ãƒ¼ã‚¹</th>
                </tr>
                <tr>
                    <td><strong>SMTP</strong></td>
                    <td>æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©åˆ©ç”¨ã€è¿½åŠ ã‚³ã‚¹ãƒˆãªã—</td>
                    <td>è¨­å®šãŒç’°å¢ƒä¾å­˜ã€åˆ°é”ç‡ã¯ç’°å¢ƒæ¬¡ç¬¬</td>
                    <td>ç¤¾å†…ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚‹</td>
                </tr>
                <tr>
                    <td><strong>AWS SES</strong></td>
                    <td>é«˜åˆ°é”ç‡ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã€AWSçµ±åˆ</td>
                    <td>AWSå¥‘ç´„å¿…è¦ã€åˆæœŸè¨­å®šãŒå¿…è¦</td>
                    <td>AWSç’°å¢ƒã‚’ä½¿ç”¨</td>
                </tr>
                <tr>
                    <td><strong>SendGrid</strong></td>
                    <td>é«˜æ©Ÿèƒ½ã€åˆ†ææ©Ÿèƒ½ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</td>
                    <td>æœ‰æ–™ï¼ˆç„¡æ–™æ ã‚ã‚Šï¼‰</td>
                    <td>å¤§é‡é…ä¿¡ã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ä½µç”¨</td>
                </tr>
            </table>
            
            <h3>SMTPæ–¹å¼ã®å®Ÿè£…</h3>
            <div class="code-block">
<span class="comment"># email_notifier.py</span>
<span class="keyword">import</span> smtplib
<span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText
<span class="keyword">from</span> email.mime.multipart <span class="keyword">import</span> MIMEMultipart
<span class="keyword">from</span> email.mime.application <span class="keyword">import</span> MIMEApplication
<span class="keyword">import</span> os
<span class="keyword">from</span> typing <span class="keyword">import</span> List, Dict

<span class="keyword">class</span> <span class="class">EmailNotifier</span>:
    <span class="string">"""ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚¯ãƒ©ã‚¹ï¼ˆSMTPï¼‰"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self):
        self.smtp_host = os.getenv(<span class="string">"SMTP_HOST"</span>, <span class="string">"smtp.example.com"</span>)
        self.smtp_port = int(os.getenv(<span class="string">"SMTP_PORT"</span>, <span class="string">"587"</span>))
        self.smtp_user = os.getenv(<span class="string">"SMTP_USER"</span>)
        self.smtp_password = os.getenv(<span class="string">"SMTP_PASSWORD"</span>)
        self.from_address = os.getenv(<span class="string">"EMAIL_FROM"</span>, <span class="string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0177746d6f2c606d647375416479606c716d642f626e6c">[email&#160;protected]</a>"</span>)
    
    <span class="keyword">def</span> <span class="function">send_email</span>(
        self,
        to: List[str],
        subject: str,
        body_html: str,
        attachments: List[str] = <span class="keyword">None</span>
    ) -> bool:
        <span class="string">"""ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡"""</span>
        
        msg = MIMEMultipart(<span class="string">"mixed"</span>)
        msg[<span class="string">"Subject"</span>] = subject
        msg[<span class="string">"From"</span>] = self.from_address
        msg[<span class="string">"To"</span>] = <span class="string">", "</span>.join(to)
        
        <span class="comment"># HTMLæœ¬æ–‡</span>
        html_part = MIMEText(body_html, <span class="string">"html"</span>, <span class="string">"utf-8"</span>)
        msg.attach(html_part)
        
        <span class="comment"># æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«</span>
        <span class="keyword">if</span> attachments:
            <span class="keyword">for</span> filepath <span class="keyword">in</span> attachments:
                <span class="keyword">with</span> open(filepath, <span class="string">"rb"</span>) <span class="keyword">as</span> f:
                    part = MIMEApplication(f.read())
                    filename = os.path.basename(filepath)
                    part.add_header(
                        <span class="string">"Content-Disposition"</span>,
                        <span class="string">"attachment"</span>,
                        filename=filename
                    )
                    msg.attach(part)
        
        <span class="comment"># é€ä¿¡</span>
        <span class="keyword">try</span>:
            <span class="keyword">with</span> smtplib.SMTP(self.smtp_host, self.smtp_port) <span class="keyword">as</span> server:
                server.starttls()
                <span class="keyword">if</span> self.smtp_user <span class="keyword">and</span> self.smtp_password:
                    server.login(self.smtp_user, self.smtp_password)
                server.send_message(msg)
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            print(f<span class="string">"ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼: {e}"</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>
            </div>
            
            <h3>AWS SESæ–¹å¼ã®å®Ÿè£…</h3>
            <div class="code-block">
<span class="comment"># ses_notifier.py</span>
<span class="keyword">import</span> boto3
<span class="keyword">from</span> botocore.exceptions <span class="keyword">import</span> ClientError
<span class="keyword">from</span> typing <span class="keyword">import</span> List

<span class="keyword">class</span> <span class="class">SESNotifier</span>:
    <span class="string">"""ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚¯ãƒ©ã‚¹ï¼ˆAWS SESï¼‰"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, region: str = <span class="string">"ap-northeast-1"</span>):
        self.client = boto3.client(<span class="string">"ses"</span>, region_name=region)
        self.from_address = <span class="string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3741425b591a565b52454377524f565a475b521954585a">[email&#160;protected]</a>"</span>
    
    <span class="keyword">def</span> <span class="function">send_email</span>(
        self,
        to: List[str],
        subject: str,
        body_html: str
    ) -> bool:
        <span class="string">"""ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡"""</span>
        
        <span class="keyword">try</span>:
            response = self.client.send_email(
                Source=self.from_address,
                Destination={
                    <span class="string">"ToAddresses"</span>: to
                },
                Message={
                    <span class="string">"Subject"</span>: {
                        <span class="string">"Data"</span>: subject,
                        <span class="string">"Charset"</span>: <span class="string">"UTF-8"</span>
                    },
                    <span class="string">"Body"</span>: {
                        <span class="string">"Html"</span>: {
                            <span class="string">"Data"</span>: body_html,
                            <span class="string">"Charset"</span>: <span class="string">"UTF-8"</span>
                        }
                    }
                }
            )
            print(f<span class="string">"é€ä¿¡æˆåŠŸ: MessageId={response['MessageId']}"</span>)
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">except</span> ClientError <span class="keyword">as</span> e:
            print(f<span class="string">"SESã‚¨ãƒ©ãƒ¼: {e.response['Error']['Message']}"</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>
            </div>
            
            <h3>è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡</h3>
            <div class="code-block">
<span class="keyword">def</span> <span class="function">send_vulnerability_alert</span>(
    self,
    to: List[str],
    vuln: Dict,
    asset: Dict,
    priority: Dict
) -> bool:
    <span class="string">"""è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡"""</span>
    
    <span class="comment"># å„ªå…ˆåº¦ã«å¿œã˜ãŸè‰²</span>
    colors = {
        <span class="string">"Immediate"</span>: <span class="string">"#cf222e"</span>,
        <span class="string">"Out-of-Cycle"</span>: <span class="string">"#bf8700"</span>,
        <span class="string">"Scheduled"</span>: <span class="string">"#0969da"</span>,
        <span class="string">"Defer"</span>: <span class="string">"#57606a"</span>
    }
    color = colors.get(priority[<span class="string">"action"</span>], <span class="string">"#0969da"</span>)
    
    html = f<span class="string">"""
    &lt;html&gt;
    &lt;body style="font-family: Arial, sans-serif; line-height: 1.6;"&gt;
        &lt;div style="background: {color}; color: white; padding: 20px;"&gt;
            &lt;h1 style="margin: 0;"&gt;ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ&lt;/h1&gt;
        &lt;/div&gt;
        &lt;div style="padding: 20px;"&gt;
            &lt;table style="width: 100%; border-collapse: collapse;"&gt;
                &lt;tr&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;"&gt;CVE ID&lt;/td&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd;"&gt;{vuln['cve_id']}&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;"&gt;CVSSã‚¹ã‚³ã‚¢&lt;/td&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd;"&gt;{vuln['cvss_score']} ({vuln['severity']})&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;"&gt;å¯¾è±¡è³‡ç”£&lt;/td&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd;"&gt;{asset['hostname']} ({asset['environment']})&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;"&gt;æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³&lt;/td&gt;
                    &lt;td style="padding: 10px; border: 1px solid #ddd; color: {color}; font-weight: bold;"&gt;{priority['action']}&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
            &lt;h3&gt;æ¦‚è¦&lt;/h3&gt;
            &lt;p&gt;{vuln['title']}&lt;/p&gt;
            &lt;p style="margin-top: 20px;"&gt;
                &lt;a href="https://nvd.nist.gov/vuln/detail/{vuln['cve_id']}" 
                   style="background: #0969da; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px;"&gt;
                    NVDã§è©³ç´°ã‚’è¦‹ã‚‹
                &lt;/a&gt;
            &lt;/p&gt;
        &lt;/div&gt;
    &lt;/body&gt;
    &lt;/html&gt;
    """</span>
    
    subject = f<span class="string">"ã€{priority['action']}ã€‘{vuln['cve_id']} - è„†å¼±æ€§æ¤œå‡º"</span>
    <span class="keyword">return</span> self.send_email(to, subject, html)
            </div>
            
            <h3>ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã®è¡¨ç¤ºã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
            <div class="email-preview">
                <div class="email-header">
                    <div class="email-header-row">
                        <span class="email-header-label">From:</span>
                        <span class="email-header-value"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c9bfbca5a7e4a8a5acbbbd89acb1a8a4b9a5ace7aaa6a4">[email&#160;protected]</a></span>
                    </div>
                    <div class="email-header-row">
                        <span class="email-header-label">To:</span>
                        <span class="email-header-value"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e19284829493889598cc9584808ca18499808c918d84cf828e8c">[email&#160;protected]</a></span>
                    </div>
                    <div class="email-header-row">
                        <span class="email-header-label">Subject:</span>
                        <span class="email-header-value">ã€Immediateã€‘CVE-2024-1234 - è„†å¼±æ€§æ¤œå‡º</span>
                    </div>
                </div>
                <div class="email-body">
                    <div style="background: #cf222e; color: white; padding: 16px; margin: -20px -20px 20px -20px;">
                        <h2 style="margin: 0; border: none; padding: 0; color: white;">ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ</h2>
                    </div>
                    <table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold; width: 30%;">CVE ID</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">CVE-2024-1234</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">CVSSã‚¹ã‚³ã‚¢</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">9.8 (Critical)</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">å¯¾è±¡è³‡ç”£</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">web-server-01 (æœ¬ç•ªç’°å¢ƒ)</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</td>
                            <td style="padding: 10px; border: 1px solid #ddd; color: #cf222e; font-weight: bold;">Immediate</td>
                        </tr>
                    </table>
                    <h3 style="border: none; padding: 0; font-size: 16px;">æ¦‚è¦</h3>
                    <p>Apache HTTP Server ã«ãŠã‘ã‚‹é‡å¤§ãªè„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚</p>
                    <p style="margin-top: 20px;">
                        <a href="#" style="background: #0969da; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;">NVDã§è©³ç´°ã‚’è¦‹ã‚‹</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- çµ±åˆé€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ -->
        <div class="section">
            <h2 class="design">ğŸ—ï¸ çµ±åˆé€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­è¨ˆ</h2>
            
            <p style="margin-bottom: 16px;">
                Teamsã€Discordã€ãƒ¡ãƒ¼ãƒ«ã‚’çµ±åˆã—ã¦ç®¡ç†ã™ã‚‹é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
            </p>
            
            <div class="code-block">
<span class="comment"># notification_service.py</span>
<span class="keyword">from</span> enum <span class="keyword">import</span> Enum
<span class="keyword">from</span> typing <span class="keyword">import</span> List, Dict
<span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass

<span class="keyword">class</span> <span class="class">NotificationChannel</span>(Enum):
    TEAMS = <span class="string">"teams"</span>
    DISCORD = <span class="string">"discord"</span>
    EMAIL = <span class="string">"email"</span>

<span class="keyword">class</span> <span class="class">NotificationType</span>(Enum):
    IMMEDIATE = <span class="string">"immediate"</span>   <span class="comment"># å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
    DAILY = <span class="string">"daily"</span>           <span class="comment"># æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</span>
    WEEKLY = <span class="string">"weekly"</span>         <span class="comment"># é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</span>

@dataclass
<span class="keyword">class</span> <span class="class">NotificationSetting</span>:
    name: str
    channel: NotificationChannel
    notification_type: NotificationType
    webhook_url: str = <span class="keyword">None</span>       <span class="comment"># Teams/Discordç”¨</span>
    recipients: List[str] = <span class="keyword">None</span>  <span class="comment"># ãƒ¡ãƒ¼ãƒ«ç”¨</span>
    min_priority: str = <span class="keyword">None</span>      <span class="comment"># ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶</span>
    environments: List[str] = <span class="keyword">None</span>
    is_active: bool = <span class="keyword">True</span>


<span class="keyword">class</span> <span class="class">NotificationService</span>:
    <span class="string">"""çµ±åˆé€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(
        self,
        teams_notifier: TeamsNotifier = <span class="keyword">None</span>,
        discord_notifier: DiscordNotifier = <span class="keyword">None</span>,
        email_notifier: EmailNotifier = <span class="keyword">None</span>,
        settings_repo = <span class="keyword">None</span>
    ):
        self.teams = teams_notifier
        self.discord = discord_notifier
        self.email = email_notifier
        self.settings_repo = settings_repo
    
    <span class="keyword">def</span> <span class="function">notify_vulnerability</span>(
        self,
        vuln: Dict,
        asset: Dict,
        priority: Dict
    ):
        <span class="string">"""è„†å¼±æ€§ã‚’é€šçŸ¥"""</span>
        
        <span class="comment"># ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªè¨­å®šã‚’å–å¾—</span>
        settings = self.settings_repo.get_active_settings(
            notification_type=NotificationType.IMMEDIATE
        )
        
        <span class="keyword">for</span> setting <span class="keyword">in</span> settings:
            <span class="comment"># æ¡ä»¶ãƒã‚§ãƒƒã‚¯</span>
            <span class="keyword">if not</span> self._matches_condition(setting, vuln, asset, priority):
                <span class="keyword">continue</span>
            
            <span class="comment"># ãƒãƒ£ãƒãƒ«åˆ¥ã«é€ä¿¡</span>
            <span class="keyword">try</span>:
                <span class="keyword">if</span> setting.channel == NotificationChannel.TEAMS:
                    self.teams.webhook_url = setting.webhook_url
                    self.teams.send_vulnerability_alert(vuln, asset, priority)
                
                <span class="keyword">elif</span> setting.channel == NotificationChannel.DISCORD:
                    self.discord.webhook_url = setting.webhook_url
                    self.discord.send_vulnerability_alert(vuln, asset, priority)
                
                <span class="keyword">elif</span> setting.channel == NotificationChannel.EMAIL:
                    self.email.send_vulnerability_alert(
                        to=setting.recipients,
                        vuln=vuln,
                        asset=asset,
                        priority=priority
                    )
                
                <span class="comment"># é€ä¿¡æˆåŠŸã‚’è¨˜éŒ²</span>
                self._log_success(setting, vuln)
                
            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
                <span class="comment"># ã‚¨ãƒ©ãƒ¼ã‚’è¨˜éŒ²</span>
                self._log_error(setting, vuln, str(e))
    
    <span class="keyword">def</span> <span class="function">_matches_condition</span>(
        self,
        setting: NotificationSetting,
        vuln: Dict,
        asset: Dict,
        priority: Dict
    ) -> bool:
        <span class="string">"""é€šçŸ¥æ¡ä»¶ã«åˆè‡´ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯"""</span>
        
        <span class="comment"># å„ªå…ˆåº¦ãƒ•ã‚£ãƒ«ã‚¿</span>
        <span class="keyword">if</span> setting.min_priority:
            priority_order = [<span class="string">"Defer"</span>, <span class="string">"Scheduled"</span>, <span class="string">"Out-of-Cycle"</span>, <span class="string">"Immediate"</span>]
            current_idx = priority_order.index(priority[<span class="string">"action"</span>])
            min_idx = priority_order.index(setting.min_priority)
            <span class="keyword">if</span> current_idx < min_idx:
                <span class="keyword">return</span> <span class="keyword">False</span>
        
        <span class="comment"># ç’°å¢ƒãƒ•ã‚£ãƒ«ã‚¿</span>
        <span class="keyword">if</span> setting.environments:
            <span class="keyword">if</span> asset[<span class="string">"environment"</span>] <span class="keyword">not in</span> setting.environments:
                <span class="keyword">return</span> <span class="keyword">False</span>
        
        <span class="keyword">return</span> <span class="keyword">True</span>
            </div>
            
            <h3>ä½¿ç”¨ä¾‹</h3>
            <div class="code-block">
<span class="comment"># åˆæœŸåŒ–</span>
service = NotificationService(
    teams_notifier=TeamsNotifier(),
    discord_notifier=DiscordNotifier(),
    email_notifier=EmailNotifier(),
    settings_repo=notification_settings_repo
)

<span class="comment"># è„†å¼±æ€§æ¤œå‡ºæ™‚ã«å‘¼ã³å‡ºã—</span>
service.notify_vulnerability(
    vuln={
        <span class="string">"cve_id"</span>: <span class="string">"CVE-2024-1234"</span>,
        <span class="string">"cvss_score"</span>: <span class="number">9.8</span>,
        <span class="string">"severity"</span>: <span class="string">"Critical"</span>,
        <span class="string">"title"</span>: <span class="string">"Apache HTTP Server ã®é‡å¤§ãªè„†å¼±æ€§"</span>
    },
    asset={
        <span class="string">"hostname"</span>: <span class="string">"web-server-01"</span>,
        <span class="string">"environment"</span>: <span class="string">"æœ¬ç•ª"</span>
    },
    priority={
        <span class="string">"action"</span>: <span class="string">"Immediate"</span>,
        <span class="string">"score"</span>: <span class="number">73.5</span>
    }
)
            </div>
        </div>

        <!-- é€šçŸ¥è¨­å®šDB -->
        <div class="section">
            <h2>ğŸ—„ï¸ é€šçŸ¥è¨­å®šã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h2>
            
            <div class="code-block">
<span class="comment">-- notification_settings ãƒ†ãƒ¼ãƒ–ãƒ«</span>
CREATE TABLE notification_settings (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    channel VARCHAR(20) NOT NULL,        <span class="comment">-- 'teams', 'discord', 'email'</span>
    notification_type VARCHAR(20) NOT NULL, <span class="comment">-- 'immediate', 'daily', 'weekly'</span>
    
    <span class="comment">-- ãƒãƒ£ãƒãƒ«åˆ¥è¨­å®š</span>
    webhook_url TEXT,                    <span class="comment">-- Teams/Discord Webhook URL</span>
    recipients TEXT[],                   <span class="comment">-- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é…åˆ—</span>
    
    <span class="comment">-- ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶</span>
    min_priority VARCHAR(20),            <span class="comment">-- 'Immediate', 'Out-of-Cycle', 'Scheduled', 'Defer'</span>
    environments TEXT[],                 <span class="comment">-- ['æœ¬ç•ª', 'ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°'] ãªã©</span>
    kev_only BOOLEAN DEFAULT FALSE,      <span class="comment">-- KEVç™»éŒ²ã®ã¿é€šçŸ¥</span>
    
    <span class="comment">-- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆæ—¥æ¬¡/é€±æ¬¡ç”¨ï¼‰</span>
    schedule_time TIME,                  <span class="comment">-- é€ä¿¡æ™‚åˆ»ï¼ˆä¾‹: '09:00:00'ï¼‰</span>
    schedule_day INTEGER,                <span class="comment">-- æ›œæ—¥ï¼ˆé€±æ¬¡ã®å ´åˆã€1=æœˆæ›œï¼‰</span>
    
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

<span class="comment">-- è¨­å®šä¾‹ã‚’æŒ¿å…¥</span>
INSERT INTO notification_settings (name, channel, notification_type, webhook_url, min_priority) VALUES
(<span class="string">'Teamsç·Šæ€¥ã‚¢ãƒ©ãƒ¼ãƒˆ'</span>, <span class="string">'teams'</span>, <span class="string">'immediate'</span>, <span class="string">'https://outlook.office.com/webhook/xxx'</span>, <span class="string">'Immediate'</span>),
(<span class="string">'Discordé–‹ç™ºãƒãƒ¼ãƒ '</span>, <span class="string">'discord'</span>, <span class="string">'immediate'</span>, <span class="string">'https://discord.com/api/webhooks/xxx'</span>, <span class="string">'Out-of-Cycle'</span>);

INSERT INTO notification_settings (name, channel, notification_type, recipients, schedule_time) VALUES
(<span class="string">'æ—¥æ¬¡ãƒ¡ãƒ¼ãƒ«ãƒ¬ãƒãƒ¼ãƒˆ'</span>, <span class="string">'email'</span>, <span class="string">'daily'</span>, ARRAY[<span class="string">'<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4d3e282e383f2439340d28352c203d2128632e2220">[email&#160;protected]</a>'</span>], <span class="string">'09:00:00'</span>);
            </div>
            
            <h3>é€šçŸ¥è¨­å®šã®ä¾‹</h3>
            <table>
                <tr>
                    <th>è¨­å®šå</th>
                    <th>ãƒãƒ£ãƒãƒ«</th>
                    <th>ã‚¿ã‚¤ãƒ—</th>
                    <th>æ¡ä»¶</th>
                </tr>
                <tr>
                    <td>Teamsç·Šæ€¥ã‚¢ãƒ©ãƒ¼ãƒˆ</td>
                    <td>Teams</td>
                    <td>å³æ™‚</td>
                    <td>Immediate ã®ã¿</td>
                </tr>
                <tr>
                    <td>Discordé–‹ç™ºãƒãƒ¼ãƒ </td>
                    <td>Discord</td>
                    <td>å³æ™‚</td>
                    <td>Out-of-Cycle ä»¥ä¸Š</td>
                </tr>
                <tr>
                    <td>ãƒ¡ãƒ¼ãƒ«ç·Šæ€¥é€šçŸ¥</td>
                    <td>ãƒ¡ãƒ¼ãƒ«</td>
                    <td>å³æ™‚</td>
                    <td>Immediate + æœ¬ç•ªç’°å¢ƒ</td>
                </tr>
                <tr>
                    <td>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ï¼ˆTeamsï¼‰</td>
                    <td>Teams</td>
                    <td>æ—¥æ¬¡</td>
                    <td>æ¯æ—¥ 09:00</td>
                </tr>
                <tr>
                    <td>é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</td>
                    <td>ãƒ¡ãƒ¼ãƒ«</td>
                    <td>é€±æ¬¡</td>
                    <td>æ¯é€±æœˆæ›œ 09:00</td>
                </tr>
            </table>
        </div>

        <!-- ç’°å¢ƒå¤‰æ•° -->
        <div class="section">
            <h2>âš™ï¸ ç’°å¢ƒå¤‰æ•°ã®è¨­å®š</h2>
            
            <div class="code-block">
<span class="comment"># .env ãƒ•ã‚¡ã‚¤ãƒ«</span>

<span class="comment"># Microsoft Teams</span>
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/xxxxxxxx

<span class="comment"># Discord</span>
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/xxxxxxxx/xxxxxxxx

<span class="comment"># ãƒ¡ãƒ¼ãƒ«ï¼ˆSMTPï¼‰</span>
SMTP_HOST=smtp.example.com
SMTP_PORT=587
<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0b58465f5b545e584e59367d7e6765266a676e797f4b6e736a667b676e25686466">[email&#160;protected]</a>
SMTP_PASSWORD=xxxxxxxx
<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9bded6dad2d7c4ddc9d4d6a6edeef7f5b6faf7fee9efdbfee3faf6ebf7feb5f8f4f6">[email&#160;protected]</a>

<span class="comment"># ãƒ¡ãƒ¼ãƒ«ï¼ˆAWS SESï¼‰- SMTP ã®ä»£ã‚ã‚Šã«ä½¿ç”¨ã™ã‚‹å ´åˆ</span>
AWS_REGION=ap-northeast-1
AWS_ACCESS_KEY_ID=xxxxxxxx
AWS_SECRET_ACCESS_KEY=xxxxxxxx
            </div>
            
            <div class="warning-box">
                <h4>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„</h4>
                <ul>
                    <li>Webhook URLã‚„èªè¨¼æƒ…å ±ã¯<strong>çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„</strong></li>
                    <li>ç’°å¢ƒå¤‰æ•°ã¾ãŸã¯ AWS Secrets Manager ç­‰ã§ç®¡ç†</li>
                    <li>æœ¬ç•ªç’°å¢ƒã§ã¯ IAM ãƒ­ãƒ¼ãƒ«ã‚’ä½¿ç”¨ï¼ˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ä¸è¦ï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- æ‹…å½“ã‚¿ã‚¹ã‚¯ -->
        <div class="section">
            <h2>ğŸ“‹ æ‹…å½“Dã®ã‚¿ã‚¹ã‚¯</h2>
            
            <table>
                <tr>
                    <th>Sprint</th>
                    <th>ã‚¿ã‚¹ã‚¯</th>
                    <th>è©³ç´°</th>
                </tr>
                <tr>
                    <td><strong>Sprint 2</strong></td>
                    <td>é€šçŸ¥åŸºç›¤ã®è¨­è¨ˆ</td>
                    <td>
                        ãƒ»é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ã®è¨­è¨ˆ<br>
                        ãƒ»é€šçŸ¥è¨­å®šDBãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ<br>
                        ãƒ»Teams/Discord Webhookå–å¾—
                    </td>
                </tr>
                <tr>
                    <td><strong>Sprint 3</strong></td>
                    <td>å³æ™‚é€šçŸ¥ã®å®Ÿè£…</td>
                    <td>
                        ãƒ»TeamsNotifierå®Ÿè£…<br>
                        ãƒ»DiscordNotifierå®Ÿè£…<br>
                        ãƒ»EmailNotifierå®Ÿè£…<br>
                        ãƒ»ãƒãƒƒãƒãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã®é€£æº
                    </td>
                </tr>
                <tr>
                    <td><strong>Sprint 4</strong></td>
                    <td>å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®å®Ÿè£…</td>
                    <td>
                        ãƒ»æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã®å®Ÿè£…<br>
                        ãƒ»é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®å®Ÿè£…<br>
                        ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼è¨­å®š
                    </td>
                </tr>
                <tr>
                    <td><strong>Sprint 5</strong></td>
                    <td>ãƒ†ã‚¹ãƒˆãƒ»æ”¹å–„</td>
                    <td>
                        ãƒ»é€šçŸ¥è¨­å®šç”»é¢ï¼ˆæ‹…å½“Eã¨é€£æºï¼‰<br>
                        ãƒ»ãƒ†ã‚¹ãƒˆé€šçŸ¥æ©Ÿèƒ½<br>
                        ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
                    </td>
                </tr>
            </table>
        </div>

        <!-- ã¾ã¨ã‚ -->
        <div class="section">
            <h2>ğŸ“ ã¾ã¨ã‚</h2>
            
            <table>
                <tr>
                    <th style="width: 20%;">ãƒãƒ£ãƒãƒ«</th>
                    <th>å®Ÿè£…æ–¹æ³•</th>
                    <th>æ¨å¥¨ç”¨é€”</th>
                </tr>
                <tr>
                    <td><strong>Teams</strong></td>
                    <td>Incoming Webhook + MessageCard</td>
                    <td>ãƒ“ã‚¸ãƒã‚¹åˆ©ç”¨ã€å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ</td>
                </tr>
                <tr>
                    <td><strong>Discord</strong></td>
                    <td>Webhook + Embed</td>
                    <td>é–‹ç™ºãƒãƒ¼ãƒ ã€æŠ€è¡“è€…å‘ã‘</td>
                </tr>
                <tr>
                    <td><strong>ãƒ¡ãƒ¼ãƒ«</strong></td>
                    <td>SMTP or AWS SES</td>
                    <td>æ­£å¼é€šçŸ¥ã€é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</td>
                </tr>
            </table>
            
            <div class="recommend-box">
                <h4>âœ… æ¨å¥¨æ§‹æˆ</h4>
                <ul>
                    <li><strong>Critical/KEVæ¤œå‡º</strong>ï¼šTeams + ãƒ¡ãƒ¼ãƒ«ï¼ˆåŒæ™‚é€ä¿¡ã§è¦‹é€ƒã—é˜²æ­¢ï¼‰</li>
                    <li><strong>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</strong>ï¼šTeams ã¾ãŸã¯ Discord</li>
                    <li><strong>é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</strong>ï¼šãƒ¡ãƒ¼ãƒ«ï¼ˆPDFæ·»ä»˜ï¼‰</li>
                    <li><strong>é–‹ç™ºãƒãƒ¼ãƒ å‘ã‘</strong>ï¼šDiscordï¼ˆæŠ€è¡“è€…ã«é¦´æŸ“ã¿ã‚„ã™ã„ï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- å‚è€ƒãƒªãƒ³ã‚¯ -->
        <div class="section">
            <h2>ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯</h2>
            
            <table>
                <tr>
                    <th style="width: 30%;">ãƒªã‚½ãƒ¼ã‚¹</th>
                    <th>URL</th>
                </tr>
                <tr>
                    <td><strong>Teams Webhook</strong></td>
                    <td><a href="https://learn.microsoft.com/ja-jp/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook" target="_blank">https://learn.microsoft.com/.../add-incoming-webhook</a></td>
                </tr>
                <tr>
                    <td><strong>Teams MessageCard</strong></td>
                    <td><a href="https://learn.microsoft.com/ja-jp/outlook/actionable-messages/message-card-reference" target="_blank">https://learn.microsoft.com/.../message-card-reference</a></td>
                </tr>
                <tr>
                    <td><strong>Discord Webhook</strong></td>
                    <td><a href="https://discord.com/developers/docs/reso