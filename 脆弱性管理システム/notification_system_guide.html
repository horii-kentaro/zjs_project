<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSlack/ãƒ¡ãƒ¼ãƒ«ï¼‰ã‚¬ã‚¤ãƒ‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: #f6f8fa;
            color: #24292f;
            line-height: 1.6;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #24292f;
            margin-bottom: 10px;
            font-size: 28px;
        }
        .subtitle {
            text-align: center;
            color: #57606a;
            margin-bottom: 30px;
        }
        
        .section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #24292f;
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e01e5a;
        }
        .section h3 {
            color: #24292f;
            font-size: 16px;
            margin: 24px 0 12px;
        }
        .section h2.email {
            border-bottom-color: #0969da;
        }
        .section h2.design {
            border-bottom-color: #2da44e;
        }
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ« */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #d0d7de;
        }
        th {
            background: #f6f8fa;
            font-weight: 600;
        }
        
        /* å›³è§£ */
        .diagram {
            background: #f6f8fa;
            border-radius: 8px;
            padding: 24px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .diagram-svg {
            width: 100%;
            min-width: 700px;
        }
        
        /* ãƒã‚¤ãƒ³ãƒˆãƒœãƒƒã‚¯ã‚¹ */
        .point-box {
            background: #ddf4ff;
            border: 1px solid #54aeff;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .point-box h4 {
            color: #0969da;
            margin-bottom: 8px;
        }
        .point-box ul {
            margin-left: 20px;
        }
        .point-box li {
            margin: 4px 0;
        }
        
        .callout {
            background: #fff8c5;
            border: 1px solid #d4a72c;
            border-radius: 8px;
            padding: 12px 16px;
            margin: 12px 0;
            font-size: 14px;
        }
        .callout::before {
            content: "ğŸ’¡";
            margin-right: 8px;
        }
        
        .recommend-box {
            background: #dafbe1;
            border: 1px solid #2da44e;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .recommend-box h4 {
            color: #1a7f37;
            margin-bottom: 8px;
        }
        
        .warning-box {
            background: #ffebe9;
            border: 1px solid #ff8182;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .warning-box h4 {
            color: #cf222e;
            margin-bottom: 8px;
        }
        
        /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
        .code-block {
            background: #24292f;
            color: #e6edf3;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 16px 0;
            line-height: 1.5;
        }
        .code-block .comment {
            color: #8b949e;
        }
        .code-block .keyword {
            color: #ff7b72;
        }
        .code-block .string {
            color: #a5d6ff;
        }
        .code-block .function {
            color: #d2a8ff;
        }
        .code-block .number {
            color: #79c0ff;
        }
        .code-block .class {
            color: #7ee787;
        }
        
        code {
            background: #f6f8fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
        }
        
        /* æ‰‹é †ãƒªã‚¹ãƒˆ */
        .steps {
            margin: 20px 0;
        }
        .step {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            padding: 16px;
            background: #f6f8fa;
            border-radius: 8px;
            border-left: 4px solid #0969da;
        }
        .step-number {
            width: 32px;
            height: 32px;
            background: #0969da;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        .step-content h4 {
            margin-bottom: 4px;
        }
        .step-content p {
            font-size: 14px;
            color: #57606a;
        }
        
        /* Slacké¢¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .slack-message {
            background: white;
            border: 1px solid #d0d7de;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            font-family: 'Slack-Lato', 'Lato', sans-serif;
        }
        .slack-message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .slack-bot-icon {
            width: 36px;
            height: 36px;
            background: #4a154b;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }
        .slack-bot-name {
            font-weight: bold;
        }
        .slack-timestamp {
            font-size: 12px;
            color: #616061;
        }
        .slack-attachment {
            border-left: 4px solid #cf222e;
            padding-left: 12px;
            margin: 8px 0;
        }
        .slack-attachment.warning {
            border-left-color: #bf8700;
        }
        .slack-attachment.info {
            border-left-color: #0969da;
        }
        .slack-attachment-title {
            font-weight: bold;
            color: #1264a3;
        }
        .slack-field {
            display: inline-block;
            margin-right: 24px;
            margin-top: 8px;
        }
        .slack-field-title {
            font-size: 12px;
            color: #616061;
            font-weight: bold;
        }
        .slack-field-value {
            font-size: 14px;
        }
        
        /* ãƒ¡ãƒ¼ãƒ«é¢¨ */
        .email-preview {
            background: white;
            border: 1px solid #d0d7de;
            border-radius: 8px;
            overflow: hidden;
            margin: 16px 0;
        }
        .email-header {
            background: #f6f8fa;
            padding: 12px 16px;
            border-bottom: 1px solid #d0d7de;
        }
        .email-header-row {
            display: flex;
            font-size: 13px;
            margin: 4px 0;
        }
        .email-header-label {
            width: 60px;
            color: #57606a;
        }
        .email-header-value {
            font-weight: 500;
        }
        .email-body {
            padding: 20px;
        }
        .email-body h2 {
            border: none;
            font-size: 18px;
            margin-bottom: 16px;
            padding: 0;
        }
        
        /* æ¯”è¼ƒã‚«ãƒ¼ãƒ‰ */
        .compare-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        .compare-card {
            border: 2px solid #d0d7de;
            border-radius: 8px;
            overflow: hidden;
        }
        .compare-card-header {
            padding: 12px 16px;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        .compare-card-header.slack { background: #4a154b; }
        .compare-card-header.email { background: #0969da; }
        .compare-card-header.webhook { background: #2da44e; }
        .compare-card-header.ses { background: #ff9900; }
        .compare-card-body {
            padding: 16px;
        }
        .compare-card-body ul {
            margin-left: 20px;
            font-size: 14px;
        }
        .compare-card-body li {
            margin: 6px 0;
        }
        
        /* é€šçŸ¥ã‚¿ã‚¤ãƒ—ã‚«ãƒ¼ãƒ‰ */
        .notification-types {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 20px 0;
        }
        .notification-type {
            border: 1px solid #d0d7de;
            border-radius: 8px;
            overflow: hidden;
            text-align: center;
        }
        .notification-type-header {
            padding: 12px;
            font-weight: bold;
            font-size: 14px;
        }
        .notification-type-header.immediate { background: #ffebe9; color: #cf222e; }
        .notification-type-header.daily { background: #fff8c5; color: #9a6700; }
        .notification-type-header.weekly { background: #ddf4ff; color: #0969da; }
        .notification-type-body {
            padding: 12px;
            font-size: 13px;
        }
        .notification-type-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .notification-types {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            body { background: white; }
            .section { box-shadow: none; border: 1px solid #ddd; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”” é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSlack/ãƒ¡ãƒ¼ãƒ«ï¼‰ã‚¬ã‚¤ãƒ‰</h1>
        <p class="subtitle">è„†å¼±æ€§æ¤œå‡ºæ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆã¨å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®å®Ÿè£…</p>

        <!-- é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦ -->
        <div class="section">
            <h2>ğŸ“‹ é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦</h2>
            
            <p style="margin-bottom: 20px;">
                ãƒãƒƒãƒãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ã§æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ã‚’ã€é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§é©åˆ‡ãªäººã«é€šçŸ¥ã—ã¾ã™ã€‚
            </p>
            
            <div class="diagram">
                <svg class="diagram-svg" viewBox="0 0 750 320" style="height: 320px;">
                    <!-- èƒŒæ™¯ -->
                    <rect x="5" y="5" width="740" height="310" rx="8" fill="white" stroke="#d0d7de" stroke-width="2"/>
                    
                    <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
                    <text x="375" y="30" text-anchor="middle" font-size="16" font-weight="bold" fill="#24292f">é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®å…¨ä½“åƒ</text>
                    
                    <!-- ãƒãƒƒãƒãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ -->
                    <rect x="30" y="100" width="140" height="100" rx="6" fill="#fff8c5" stroke="#d4a72c" stroke-width="2"/>
                    <text x="100" y="130" text-anchor="middle" font-size="12" font-weight="bold" fill="#9a6700">ãƒãƒƒãƒãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³</text>
                    <text x="100" y="150" text-anchor="middle" font-size="10" fill="#57606a">æ–°è¦è„†å¼±æ€§æ¤œå‡º</text>
                    <text x="100" y="170" text-anchor="middle" font-size="10" fill="#57606a">å·®åˆ†æƒ…å ±</text>
                    <text x="100" y="190" text-anchor="middle" font-size="10" fill="#57606a">å„ªå…ˆåº¦ã‚¹ã‚³ã‚¢</text>
                    
                    <!-- é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ -->
                    <rect x="230" y="70" width="180" height="160" rx="8" fill="#fbefff" stroke="#8250df" stroke-width="3"/>
                    <text x="320" y="100" text-anchor="middle" font-size="14" font-weight="bold" fill="#8250df">é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹</text>
                    <text x="320" y="120" text-anchor="middle" font-size="10" fill="#57606a">ï¼ˆæ‹…å½“Då®Ÿè£…ï¼‰</text>
                    
                    <rect x="245" y="135" width="150" height="80" rx="4" fill="white"/>
                    <text x="255" y="155" font-size="10" fill="#24292f">ğŸ“‹ é€šçŸ¥ãƒ«ãƒ¼ãƒ«åˆ¤å®š</text>
                    <text x="255" y="175" font-size="10" fill="#24292f">ğŸ“ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ</text>
                    <text x="255" y="195" font-size="10" fill="#24292f">ğŸ“¤ é…ä¿¡å‡¦ç†</text>
                    
                    <!-- Slack -->
                    <rect x="480" y="55" width="120" height="80" rx="6" fill="#4a154b"/>
                    <text x="540" y="85" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Slack</text>
                    <text x="540" y="105" text-anchor="middle" font-size="10" fill="#e8d5e8">Incoming Webhook</text>
                    <text x="540" y="120" text-anchor="middle" font-size="10" fill="#e8d5e8">å³æ™‚é€šçŸ¥å‘ã‘</text>
                    
                    <!-- Email -->
                    <rect x="480" y="155" width="120" height="80" rx="6" fill="#0969da"/>
                    <text x="540" y="185" text-anchor="middle" font-size="12" font-weight="bold" fill="white">ãƒ¡ãƒ¼ãƒ«</text>
                    <text x="540" y="205" text-anchor="middle" font-size="10" fill="#c8e1ff">AWS SES / SMTP</text>
                    <text x="540" y="220" text-anchor="middle" font-size="10" fill="#c8e1ff">ãƒ¬ãƒãƒ¼ãƒˆå‘ã‘</text>
                    
                    <!-- Teamsï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ -->
                    <rect x="620" y="105" width="100" height="60" rx="6" fill="#5558af" opacity="0.5"/>
                    <text x="670" y="130" text-anchor="middle" font-size="10" font-weight="bold" fill="white">Teams</text>
                    <text x="670" y="145" text-anchor="middle" font-size="9" fill="#c8c8ff">ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</text>
                    
                    <!-- çŸ¢å° -->
                    <line x1="170" y1="150" x2="230" y2="150" stroke="#8c959f" stroke-width="2" marker-end="url(#arrow4)"/>
                    <path d="M 410 120 L 480 95" fill="none" stroke="#8c959f" stroke-width="2" marker-end="url(#arrow4)"/>
                    <path d="M 410 180 L 480 195" fill="none" stroke="#8c959f" stroke-width="2" marker-end="url(#arrow4)"/>
                    
                    <!-- ãƒ©ãƒ™ãƒ« -->
                    <text x="185" y="140" font-size="9" fill="#57606a">ã‚¤ãƒ™ãƒ³ãƒˆ</text>
                    <text x="430" y="100" font-size="9" fill="#57606a">å³æ™‚</text>
                    <text x="430" y="200" font-size="9" fill="#57606a">å®šæœŸ</text>
                    
                    <!-- DB -->
                    <rect x="230" y="250" width="180" height="50" rx="6" fill="#ddf4ff" stroke="#0969da" stroke-width="2"/>
                    <text x="320" y="275" text-anchor="middle" font-size="11" font-weight="bold" fill="#0969da">é€šçŸ¥è¨­å®šDB</text>
                    <text x="320" y="290" text-anchor="middle" font-size="9" fill="#57606a">å®›å…ˆãƒ»æ¡ä»¶ãƒ»å±¥æ­´</text>
                    
                    <line x1="320" y1="230" x2="320" y2="250" stroke="#8c959f" stroke-width="2"/>
                    
                    <defs>
                        <marker id="arrow4" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#8c959f"/>
                        </marker>
                    </defs>
                </svg>
            </div>
            
            <h3>é€šçŸ¥ã®ç¨®é¡</h3>
            <div class="notification-types">
                <div class="notification-type">
                    <div class="notification-type-header immediate">å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
                    <div class="notification-type-body">
                        <div class="notification-type-icon">ğŸš¨</div>
                        <p><strong>ãƒˆãƒªã‚¬ãƒ¼ï¼š</strong><br>Criticalæ¤œå‡º/KEVç™»éŒ²</p>
                        <p style="margin-top: 8px;"><strong>é…ä¿¡å…ˆï¼š</strong><br>Slack + ãƒ¡ãƒ¼ãƒ«</p>
                    </div>
                </div>
                <div class="notification-type">
                    <div class="notification-type-header daily">æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</div>
                    <div class="notification-type-body">
                        <div class="notification-type-icon">ğŸ“Š</div>
                        <p><strong>ãƒˆãƒªã‚¬ãƒ¼ï¼š</strong><br>æ¯æœ 9:00</p>
                        <p style="margin-top: 8px;"><strong>é…ä¿¡å…ˆï¼š</strong><br>Slack / ãƒ¡ãƒ¼ãƒ«</p>
                    </div>
                </div>
                <div class="notification-type">
                    <div class="notification-type-header weekly">é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</div>
                    <div class="notification-type-body">
                        <div class="notification-type-icon">ğŸ“‘</div>
                        <p><strong>ãƒˆãƒªã‚¬ãƒ¼ï¼š</strong><br>æ¯é€±æœˆæ›œ 9:00</p>
                        <p style="margin-top: 8px;"><strong>é…ä¿¡å…ˆï¼š</strong><br>ãƒ¡ãƒ¼ãƒ«ï¼ˆPDFæ·»ä»˜ï¼‰</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slacké€šçŸ¥ -->
        <div class="section">
            <h2>ğŸ’¬ Slacké€šçŸ¥</h2>
            
            <p style="margin-bottom: 16px;">
                Slackã¸ã®é€šçŸ¥ã¯<strong>Incoming Webhook</strong>ã‚’ä½¿ã†ã®ãŒæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚
            </p>
            
            <div class="compare-cards">
                <div class="compare-card">
                    <div class="compare-card-header webhook">Incoming Webhookï¼ˆæ¨å¥¨ï¼‰</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>URLã«POSTã™ã‚‹ã ã‘</li>
                            <li>è¨­å®šãŒç°¡å˜</li>
                            <li>ä¸€æ–¹å‘é€šçŸ¥ã«æœ€é©</li>
                            <li>ãƒãƒ£ãƒ³ãƒãƒ«å›ºå®š</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #2da44e;">
                            âœ… è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆã«ã¯ã“ã¡ã‚‰ã§ååˆ†
                        </p>
                    </div>
                </div>
                <div class="compare-card">
                    <div class="compare-card-header slack">Slack APIï¼ˆBot Tokenï¼‰</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>åŒæ–¹å‘ã®ã‚„ã‚Šå–ã‚Šå¯èƒ½</li>
                            <li>å‹•çš„ã«ãƒãƒ£ãƒ³ãƒãƒ«é¸æŠ</li>
                            <li>ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³å–å¾—ãªã©</li>
                            <li>è¨­å®šãŒã‚„ã‚„è¤‡é›‘</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #57606a;">
                            å°†æ¥çš„ã«å¯¾è©±æ©Ÿèƒ½ãŒå¿…è¦ãªå ´åˆ
                        </p>
                    </div>
                </div>
            </div>
            
            <h3>Incoming Webhook ã®è¨­å®šæ‰‹é †</h3>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>Slack Appã‚’ä½œæˆ</h4>
                        <p><a href="https://api.slack.com/apps" target="_blank">https://api.slack.com/apps</a> â†’ ã€ŒCreate New Appã€â†’ã€ŒFrom scratchã€</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Incoming Webhooksã‚’æœ‰åŠ¹åŒ–</h4>
                        <p>å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ŒIncoming Webhooksã€â†’ ãƒˆã‚°ãƒ«ã‚’ON</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>Webhook URLã‚’ç”Ÿæˆ</h4>
                        <p>ã€ŒAdd New Webhook to Workspaceã€â†’ é€šçŸ¥å…ˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’é¸æŠ â†’ URLã‚’ã‚³ãƒ”ãƒ¼</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>URLã‚’ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜</h4>
                        <p><code>SLACK_WEBHOOK_URL=https://hooks.slack.com/services/XXXXX/XXXXX/XXXXX</code></p>
                    </div>
                </div>
            </div>
            
            <h3>åŸºæœ¬çš„ãªé€šçŸ¥ã‚³ãƒ¼ãƒ‰</h3>
            <div class="code-block">
<span class="comment"># slack_notifier.py</span>
<span class="keyword">import</span> requests
<span class="keyword">import</span> os
<span class="keyword">from</span> typing <span class="keyword">import</span> List, Dict

<span class="keyword">class</span> <span class="class">SlackNotifier</span>:
    <span class="string">"""Slacké€šçŸ¥ã‚¯ãƒ©ã‚¹"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, webhook_url: str = <span class="keyword">None</span>):
        self.webhook_url = webhook_url <span class="keyword">or</span> os.getenv(<span class="string">"SLACK_WEBHOOK_URL"</span>)
    
    <span class="keyword">def</span> <span class="function">send_message</span>(self, text: str, blocks: List[Dict] = <span class="keyword">None</span>) -> bool:
        <span class="string">"""ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡"""</span>
        payload = {<span class="string">"text"</span>: text}
        
        <span class="keyword">if</span> blocks:
            payload[<span class="string">"blocks"</span>] = blocks
        
        response = requests.post(self.webhook_url, json=payload)
        <span class="keyword">return</span> response.status_code == <span class="number">200</span>
    
    <span class="keyword">def</span> <span class="function">send_vulnerability_alert</span>(self, vuln: Dict, asset: Dict, priority: Dict):
        <span class="string">"""è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é€ä¿¡"""</span>
        
        <span class="comment"># å„ªå…ˆåº¦ã«å¿œã˜ãŸè‰²</span>
        colors = {
            <span class="string">"Immediate"</span>: <span class="string">"#cf222e"</span>,
            <span class="string">"Out-of-Cycle"</span>: <span class="string">"#bf8700"</span>,
            <span class="string">"Scheduled"</span>: <span class="string">"#0969da"</span>,
            <span class="string">"Defer"</span>: <span class="string">"#57606a"</span>
        }
        color = colors.get(priority[<span class="string">"action"</span>], <span class="string">"#57606a"</span>)
        
        blocks = [
            {
                <span class="string">"type"</span>: <span class="string">"header"</span>,
                <span class="string">"text"</span>: {
                    <span class="string">"type"</span>: <span class="string">"plain_text"</span>,
                    <span class="string">"text"</span>: <span class="string">"ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ"</span>,
                    <span class="string">"emoji"</span>: <span class="keyword">True</span>
                }
            },
            {
                <span class="string">"type"</span>: <span class="string">"section"</span>,
                <span class="string">"fields"</span>: [
                    {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*CVE ID:*\n{vuln['cve_id']}"</span>},
                    {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*CVSS:*\n{vuln['cvss_score']}"</span>},
                    {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*å¯¾è±¡è³‡ç”£:*\n{asset['hostname']}"</span>},
                    {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*å„ªå…ˆåº¦:*\n{priority['action']}"</span>}
                ]
            },
            {
                <span class="string">"type"</span>: <span class="string">"section"</span>,
                <span class="string">"text"</span>: {
                    <span class="string">"type"</span>: <span class="string">"mrkdwn"</span>,
                    <span class="string">"text"</span>: f<span class="string">"*æ¦‚è¦:*\n{vuln['title']}"</span>
                }
            },
            {
                <span class="string">"type"</span>: <span class="string">"actions"</span>,
                <span class="string">"elements"</span>: [
                    {
                        <span class="string">"type"</span>: <span class="string">"button"</span>,
                        <span class="string">"text"</span>: {<span class="string">"type"</span>: <span class="string">"plain_text"</span>, <span class="string">"text"</span>: <span class="string">"è©³ç´°ã‚’è¦‹ã‚‹"</span>},
                        <span class="string">"url"</span>: f<span class="string">"https://nvd.nist.gov/vuln/detail/{vuln['cve_id']}"</span>
                    }
                ]
            }
        ]
        
        <span class="keyword">return</span> self.send_message(
            text=f<span class="string">"ğŸš¨ {vuln['cve_id']} ãŒ {asset['hostname']} ã§æ¤œå‡ºã•ã‚Œã¾ã—ãŸ"</span>,
            blocks=blocks
        )
            </div>
            
            <h3>Slacké€šçŸ¥ã®è¡¨ç¤ºã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
            <div class="slack-message">
                <div class="slack-message-header">
                    <div class="slack-bot-icon">ğŸ›¡ï¸</div>
                    <span class="slack-bot-name">è„†å¼±æ€§ç®¡ç†Bot</span>
                    <span class="slack-timestamp">10:30 AM</span>
                </div>
                <div style="font-weight: bold; font-size: 16px; margin-bottom: 12px;">ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ</div>
                <div class="slack-attachment">
                    <div class="slack-field">
                        <div class="slack-field-title">CVE ID</div>
                        <div class="slack-field-value">CVE-2024-1234</div>
                    </div>
                    <div class="slack-field">
                        <div class="slack-field-title">CVSS</div>
                        <div class="slack-field-value">9.8 (Critical)</div>
                    </div>
                    <div class="slack-field">
                        <div class="slack-field-title">å¯¾è±¡è³‡ç”£</div>
                        <div class="slack-field-value">web-server-01</div>
                    </div>
                    <div class="slack-field">
                        <div class="slack-field-title">å„ªå…ˆåº¦</div>
                        <div class="slack-field-value">Immediate</div>
                    </div>
                    <div style="margin-top: 12px;">
                        <div class="slack-field-title">æ¦‚è¦</div>
                        <div class="slack-field-value">Apache HTTP Server ã«ãŠã‘ã‚‹é‡å¤§ãªè„†å¼±æ€§</div>
                    </div>
                </div>
                <div style="margin-top: 12px;">
                    <button style="background: #007a5a; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">è©³ç´°ã‚’è¦‹ã‚‹</button>
                </div>
            </div>
            
            <h3>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã®é€ä¿¡</h3>
            <div class="code-block">
<span class="keyword">def</span> <span class="function">send_daily_summary</span>(self, summary: Dict):
    <span class="string">"""æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã‚’é€ä¿¡"""</span>
    
    blocks = [
        {
            <span class="string">"type"</span>: <span class="string">"header"</span>,
            <span class="string">"text"</span>: {
                <span class="string">"type"</span>: <span class="string">"plain_text"</span>,
                <span class="string">"text"</span>: <span class="string">"ğŸ“Š è„†å¼±æ€§æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ"</span>
            }
        },
        {
            <span class="string">"type"</span>: <span class="string">"section"</span>,
            <span class="string">"fields"</span>: [
                {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*æ–°è¦æ¤œå‡º:*\n{summary['new_count']}ä»¶"</span>},
                {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*è§£æ¶ˆ:*\n{summary['resolved_count']}ä»¶"</span>},
                {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*æœªå¯¾å¿œ:*\n{summary['open_count']}ä»¶"</span>},
                {<span class="string">"type"</span>: <span class="string">"mrkdwn"</span>, <span class="string">"text"</span>: f<span class="string">"*Critical:*\n{summary['critical_count']}ä»¶"</span>}
            ]
        },
        {
            <span class="string">"type"</span>: <span class="string">"divider"</span>
        },
        {
            <span class="string">"type"</span>: <span class="string">"section"</span>,
            <span class="string">"text"</span>: {
                <span class="string">"type"</span>: <span class="string">"mrkdwn"</span>,
                <span class="string">"text"</span>: <span class="string">"&lt;https://vuln-dashboard.example.com|ğŸ“ˆ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã&gt;"</span>
            }
        }
    ]
    
    <span class="keyword">return</span> self.send_message(
        text=f<span class="string">"ğŸ“Š æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ: æ–°è¦{summary['new_count']}ä»¶"</span>,
        blocks=blocks
    )
            </div>
        </div>

        <!-- ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ -->
        <div class="section">
            <h2 class="email">ğŸ“§ ãƒ¡ãƒ¼ãƒ«é€šçŸ¥</h2>
            
            <p style="margin-bottom: 16px;">
                ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã¯ã€è©³ç´°ãªãƒ¬ãƒãƒ¼ãƒˆã‚„æ­£å¼ãªé€šçŸ¥ã«é©ã—ã¦ã„ã¾ã™ã€‚
            </p>
            
            <div class="compare-cards">
                <div class="compare-card">
                    <div class="compare-card-header email">SMTPï¼ˆç¤¾å†…ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ï¼‰</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©ã‚’åˆ©ç”¨</li>
                            <li>è¿½åŠ ã‚³ã‚¹ãƒˆãªã—</li>
                            <li>ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§å®Œçµ</li>
                            <li>è¨­å®šã¯ç¤¾å†…ITéƒ¨é–€ã¨èª¿æ•´</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #0969da;">
                            âœ… ç¤¾å†…ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚‹å ´åˆ
                        </p>
                    </div>
                </div>
                <div class="compare-card">
                    <div class="compare-card-header ses">AWS SES</div>
                    <div class="compare-card-body">
                        <ul>
                            <li>é«˜ã„åˆ°é”ç‡</li>
                            <li>å¤§é‡é…ä¿¡å¯¾å¿œ</li>
                            <li>AWSã¨ã®çµ±åˆãŒå®¹æ˜“</li>
                            <li>å¾“é‡èª²é‡‘ï¼ˆ1,000é€š/$0.10ï¼‰</li>
                        </ul>
                        <p style="margin-top: 12px; font-size: 13px; color: #ff9900;">
                            âœ… AWSç’°å¢ƒãªã‚‰æ¨å¥¨
                        </p>
                    </div>
                </div>
            </div>
            
            <h3>SMTPæ–¹å¼ã®å®Ÿè£…</h3>
            <div class="code-block">
<span class="comment"># email_notifier.py</span>
<span class="keyword">import</span> smtplib
<span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText
<span class="keyword">from</span> email.mime.multipart <span class="keyword">import</span> MIMEMultipart
<span class="keyword">from</span> email.mime.application <span class="keyword">import</span> MIMEApplication
<span class="keyword">import</span> os

<span class="keyword">class</span> <span class="class">EmailNotifier</span>:
    <span class="string">"""ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚¯ãƒ©ã‚¹ï¼ˆSMTPï¼‰"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self):
        self.smtp_host = os.getenv(<span class="string">"SMTP_HOST"</span>, <span class="string">"smtp.example.com"</span>)
        self.smtp_port = int(os.getenv(<span class="string">"SMTP_PORT"</span>, <span class="string">"587"</span>))
        self.smtp_user = os.getenv(<span class="string">"SMTP_USER"</span>)
        self.smtp_password = os.getenv(<span class="string">"SMTP_PASSWORD"</span>)
        self.from_address = os.getenv(<span class="string">"EMAIL_FROM"</span>, <span class="string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6117140d0f4c000d041315210419000c110d044f020e0c">[email&#160;protected]</a>"</span>)
    
    <span class="keyword">def</span> <span class="function">send_email</span>(
        self,
        to: list,
        subject: str,
        body_html: str,
        attachments: list = <span class="keyword">None</span>
    ) -> bool:
        <span class="string">"""ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡"""</span>
        
        msg = MIMEMultipart(<span class="string">"alternative"</span>)
        msg[<span class="string">"Subject"</span>] = subject
        msg[<span class="string">"From"</span>] = self.from_address
        msg[<span class="string">"To"</span>] = <span class="string">", "</span>.join(to)
        
        <span class="comment"># HTMLæœ¬æ–‡</span>
        msg.attach(MIMEText(body_html, <span class="string">"html"</span>))
        
        <span class="comment"># æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«</span>
        <span class="keyword">if</span> attachments:
            <span class="keyword">for</span> filepath <span class="keyword">in</span> attachments:
                <span class="keyword">with</span> open(filepath, <span class="string">"rb"</span>) <span class="keyword">as</span> f:
                    part = MIMEApplication(f.read())
                    part.add_header(
                        <span class="string">"Content-Disposition"</span>,
                        <span class="string">"attachment"</span>,
                        filename=os.path.basename(filepath)
                    )
                    msg.attach(part)
        
        <span class="comment"># é€ä¿¡</span>
        <span class="keyword">try</span>:
            <span class="keyword">with</span> smtplib.SMTP(self.smtp_host, self.smtp_port) <span class="keyword">as</span> server:
                server.starttls()
                server.login(self.smtp_user, self.smtp_password)
                server.send_message(msg)
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            print(f<span class="string">"ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼: {e}"</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>
            </div>
            
            <h3>AWS SESæ–¹å¼ã®å®Ÿè£…</h3>
            <div class="code-block">
<span class="comment"># ses_notifier.py</span>
<span class="keyword">import</span> boto3
<span class="keyword">from</span> botocore.exceptions <span class="keyword">import</span> ClientError

<span class="keyword">class</span> <span class="class">SESNotifier</span>:
    <span class="string">"""ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚¯ãƒ©ã‚¹ï¼ˆAWS SESï¼‰"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(self, region: str = <span class="string">"ap-northeast-1"</span>):
        self.client = boto3.client(<span class="string">"ses"</span>, region_name=region)
        self.from_address = <span class="string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4d3b382123602c21283f390d28352c203d2128632e2220">[email&#160;protected]</a>"</span>
    
    <span class="keyword">def</span> <span class="function">send_email</span>(
        self,
        to: list,
        subject: str,
        body_html: str
    ) -> bool:
        <span class="string">"""ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡"""</span>
        
        <span class="keyword">try</span>:
            response = self.client.send_email(
                Source=self.from_address,
                Destination={
                    <span class="string">"ToAddresses"</span>: to
                },
                Message={
                    <span class="string">"Subject"</span>: {
                        <span class="string">"Data"</span>: subject,
                        <span class="string">"Charset"</span>: <span class="string">"UTF-8"</span>
                    },
                    <span class="string">"Body"</span>: {
                        <span class="string">"Html"</span>: {
                            <span class="string">"Data"</span>: body_html,
                            <span class="string">"Charset"</span>: <span class="string">"UTF-8"</span>
                        }
                    }
                }
            )
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">except</span> ClientError <span class="keyword">as</span> e:
            print(f<span class="string">"SESã‚¨ãƒ©ãƒ¼: {e}"</span>)
            <span class="keyword">return</span> <span class="keyword">False</span>
            </div>
            
            <div class="callout">
                AWS SESã‚’ä½¿ã†å ´åˆã€é€ä¿¡å…ƒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ¤œè¨¼ï¼ˆVerificationï¼‰ãŒå¿…è¦ã§ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹è§£é™¤ã‚‚å¿…è¦ã«ãªã‚Šã¾ã™ã€‚
            </div>
            
            <h3>ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã®è¡¨ç¤ºã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
            <div class="email-preview">
                <div class="email-header">
                    <div class="email-header-row">
                        <span class="email-header-label">From:</span>
                        <span class="email-header-value"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6a1c1f0604470b060f181e2a0f120b071a060f44090507">[email&#160;protected]</a></span>
                    </div>
                    <div class="email-header-row">
                        <span class="email-header-label">To:</span>
                        <span class="email-header-value"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5625333523243f222f7b2233373b16332e373b263a337835393b">[email&#160;protected]</a></span>
                    </div>
                    <div class="email-header-row">
                        <span class="email-header-label">Subject:</span>
                        <span class="email-header-value">ã€é‡è¦ã€‘æ–°è¦è„†å¼±æ€§æ¤œå‡º: CVE-2024-1234ï¼ˆCriticalï¼‰</span>
                    </div>
                </div>
                <div class="email-body">
                    <h2 style="color: #cf222e;">ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ</h2>
                    <table style="margin: 16px 0; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">CVE ID</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">CVE-2024-1234</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">CVSSã‚¹ã‚³ã‚¢</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">9.8ï¼ˆCriticalï¼‰</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">å¯¾è±¡è³‡ç”£</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">web-server-01ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; background: #f6f8fa; font-weight: bold;">æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</td>
                            <td style="padding: 8px; border: 1px solid #ddd; color: #cf222e; font-weight: bold;">Immediateï¼ˆ24æ™‚é–“ä»¥å†…ã«å¯¾å¿œï¼‰</td>
                        </tr>
                    </table>
                    <p><strong>æ¦‚è¦ï¼š</strong>Apache HTTP Server ã«ãŠã‘ã‚‹é‡å¤§ãªè„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚</p>
                    <p style="margin-top: 16px;">
                        <a href="#" style="background: #0969da; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§è©³ç´°ã‚’ç¢ºèª</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- HTMLãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="section">
            <h2>ğŸ“ HTMLãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h2>
            
            <div class="code-block">
<span class="comment"># templates/vulnerability_alert.html</span>
VULNERABILITY_ALERT_TEMPLATE = <span class="string">"""
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;style&gt;
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        .header { background: #cf222e; color: white; padding: 20px; }
        .content { padding: 20px; }
        .info-table { width: 100%; border-collapse: collapse; margin: 16px 0; }
        .info-table th { background: #f6f8fa; text-align: left; padding: 10px; border: 1px solid #ddd; }
        .info-table td { padding: 10px; border: 1px solid #ddd; }
        .btn { display: inline-block; background: #0969da; color: white; padding: 12px 24px; 
               text-decoration: none; border-radius: 4px; }
        .critical { color: #cf222e; font-weight: bold; }
        .high { color: #bf8700; font-weight: bold; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="header"&gt;
        &lt;h1&gt;ğŸš¨ æ–°ã—ã„è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ&lt;/h1&gt;
    &lt;/div&gt;
    &lt;div class="content"&gt;
        &lt;table class="info-table"&gt;
            &lt;tr&gt;&lt;th&gt;CVE ID&lt;/th&gt;&lt;td&gt;{{ cve_id }}&lt;/td&gt;&lt;/tr&gt;
            &lt;tr&gt;&lt;th&gt;CVSSã‚¹ã‚³ã‚¢&lt;/th&gt;&lt;td&gt;{{ cvss_score }} ({{ severity }})&lt;/td&gt;&lt;/tr&gt;
            &lt;tr&gt;&lt;th&gt;å¯¾è±¡è³‡ç”£&lt;/th&gt;&lt;td&gt;{{ hostname }} ({{ environment }})&lt;/td&gt;&lt;/tr&gt;
            &lt;tr&gt;&lt;th&gt;æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³&lt;/th&gt;&lt;td class="{{ action_class }}"&gt;{{ action }}&lt;/td&gt;&lt;/tr&gt;
        &lt;/table&gt;
        &lt;h3&gt;æ¦‚è¦&lt;/h3&gt;
        &lt;p&gt;{{ description }}&lt;/p&gt;
        &lt;p style="margin-top: 20px;"&gt;
            &lt;a href="{{ dashboard_url }}" class="btn"&gt;ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§è©³ç´°ã‚’ç¢ºèª&lt;/a&gt;
        &lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
"""</span>

<span class="comment"># ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§å¤‰æ•°ã‚’åŸ‹ã‚è¾¼ã¿</span>
<span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template

<span class="keyword">def</span> <span class="function">render_alert_email</span>(vuln: Dict, asset: Dict, priority: Dict) -> str:
    template = Template(VULNERABILITY_ALERT_TEMPLATE)
    <span class="keyword">return</span> template.render(
        cve_id=vuln[<span class="string">"cve_id"</span>],
        cvss_score=vuln[<span class="string">"cvss_score"</span>],
        severity=vuln[<span class="string">"severity"</span>],
        hostname=asset[<span class="string">"hostname"</span>],
        environment=asset[<span class="string">"environment"</span>],
        action=priority[<span class="string">"action"</span>],
        action_class=priority[<span class="string">"action"</span>].lower(),
        description=vuln[<span class="string">"title"</span>],
        dashboard_url=<span class="string">"https://vuln-dashboard.example.com"</span>
    )
            </div>
        </div>

        <!-- é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­è¨ˆ -->
        <div class="section">
            <h2 class="design">ğŸ—ï¸ é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­è¨ˆ</h2>
            
            <h3>é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹</h3>
            <div class="code-block">
<span class="comment"># notification_service.py</span>
<span class="keyword">from</span> typing <span class="keyword">import</span> List, Dict
<span class="keyword">from</span> enum <span class="keyword">import</span> Enum
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="keyword">class</span> <span class="class">NotificationType</span>(Enum):
    IMMEDIATE = <span class="string">"immediate"</span>    <span class="comment"># å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
    DAILY = <span class="string">"daily"</span>            <span class="comment"># æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</span>
    WEEKLY = <span class="string">"weekly"</span>          <span class="comment"># é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</span>

<span class="keyword">class</span> <span class="class">NotificationChannel</span>(Enum):
    SLACK = <span class="string">"slack"</span>
    EMAIL = <span class="string">"email"</span>

<span class="keyword">class</span> <span class="class">NotificationService</span>:
    <span class="string">"""é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(
        self,
        slack_notifier: SlackNotifier,
        email_notifier: EmailNotifier,
        settings_repo: NotificationSettingsRepository
    ):
        self.slack = slack_notifier
        self.email = email_notifier
        self.settings_repo = settings_repo
    
    <span class="keyword">def</span> <span class="function">notify_new_vulnerability</span>(
        self,
        vuln: Dict,
        asset: Dict,
        priority: Dict
    ):
        <span class="string">"""æ–°è¦è„†å¼±æ€§ã‚’é€šçŸ¥"""</span>
        
        <span class="comment"># é€šçŸ¥è¨­å®šã‚’å–å¾—</span>
        settings = self.settings_repo.get_active_settings()
        
        <span class="keyword">for</span> setting <span class="keyword">in</span> settings:
            <span class="comment"># æ¡ä»¶ã«åˆè‡´ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯</span>
            <span class="keyword">if not</span> self._matches_condition(setting, vuln, asset, priority):
                <span class="keyword">continue</span>
            
            <span class="comment"># é€šçŸ¥ã‚’é€ä¿¡</span>
            <span class="keyword">if</span> setting.channel == NotificationChannel.SLACK:
                self.slack.send_vulnerability_alert(vuln, asset, priority)
            <span class="keyword">elif</span> setting.channel == NotificationChannel.EMAIL:
                html = render_alert_email(vuln, asset, priority)
                self.email.send_email(
                    to=setting.recipients,
                    subject=f<span class="string">"ã€{priority['action']}ã€‘{vuln['cve_id']} ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ"</span>,
                    body_html=html
                )
            
            <span class="comment"># é€šçŸ¥å±¥æ­´ã‚’ä¿å­˜</span>
            self._save_history(setting, vuln, asset)
    
    <span class="keyword">def</span> <span class="function">_matches_condition</span>(
        self,
        setting,
        vuln: Dict,
        asset: Dict,
        priority: Dict
    ) -> bool:
        <span class="string">"""é€šçŸ¥æ¡ä»¶ã«åˆè‡´ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯"""</span>
        
        <span class="comment"># å„ªå…ˆåº¦ãƒ•ã‚£ãƒ«ã‚¿</span>
        <span class="keyword">if</span> setting.min_priority:
            priority_order = [<span class="string">"Defer"</span>, <span class="string">"Scheduled"</span>, <span class="string">"Out-of-Cycle"</span>, <span class="string">"Immediate"</span>]
            <span class="keyword">if</span> priority_order.index(priority[<span class="string">"action"</span>]) < priority_order.index(setting.min_priority):
                <span class="keyword">return</span> <span class="keyword">False</span>
        
        <span class="comment"># ç’°å¢ƒãƒ•ã‚£ãƒ«ã‚¿</span>
        <span class="keyword">if</span> setting.environments <span class="keyword">and</span> asset[<span class="string">"environment"</span>] <span class="keyword">not in</span> setting.environments:
            <span class="keyword">return</span> <span class="keyword">False</span>
        
        <span class="comment"># KEVãƒ•ã‚£ãƒ«ã‚¿ï¼ˆKEVã®ã¿é€šçŸ¥ï¼‰</span>
        <span class="keyword">if</span> setting.kev_only <span class="keyword">and not</span> vuln.get(<span class="string">"is_in_kev"</span>):
            <span class="keyword">return</span> <span class="keyword">False</span>
        
        <span class="keyword">return</span> <span class="keyword">True</span>
            </div>
            
            <h3>é€šçŸ¥è¨­å®šã®DBãƒ†ãƒ¼ãƒ–ãƒ«</h3>
            <div class="code-block">
<span class="comment">-- notification_settings ãƒ†ãƒ¼ãƒ–ãƒ«</span>
CREATE TABLE notification_settings (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    channel VARCHAR(20) NOT NULL,       <span class="comment">-- 'slack' or 'email'</span>
    notification_type VARCHAR(20) NOT NULL, <span class="comment">-- 'immediate', 'daily', 'weekly'</span>
    
    <span class="comment">-- å®›å…ˆ</span>
    webhook_url TEXT,                   <span class="comment">-- Slack Webhook URL</span>
    recipients TEXT[],                  <span class="comment">-- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é…åˆ—</span>
    
    <span class="comment">-- ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶</span>
    min_priority VARCHAR(20),           <span class="comment">-- æœ€ä½å„ªå…ˆåº¦ï¼ˆã“ã‚Œä»¥ä¸Šã®ã¿é€šçŸ¥ï¼‰</span>
    environments TEXT[],                <span class="comment">-- å¯¾è±¡ç’°å¢ƒï¼ˆNULLã¯å…¨ã¦ï¼‰</span>
    kev_only BOOLEAN DEFAULT FALSE,     <span class="comment">-- KEVç™»éŒ²ã®ã¿</span>
    
    <span class="comment">-- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆæ—¥æ¬¡/é€±æ¬¡ç”¨ï¼‰</span>
    schedule_time TIME,                 <span class="comment">-- é€ä¿¡æ™‚åˆ»</span>
    schedule_day INTEGER,               <span class="comment">-- æ›œæ—¥ï¼ˆé€±æ¬¡ã®å ´åˆã€0=æ—¥æ›œï¼‰</span>
    
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

<span class="comment">-- notification_history ãƒ†ãƒ¼ãƒ–ãƒ«</span>
CREATE TABLE notification_history (
    id SERIAL PRIMARY KEY,
    setting_id INTEGER REFERENCES notification_settings(id),
    vulnerability_id INTEGER REFERENCES vulnerabilities(id),
    asset_id INTEGER REFERENCES assets(id),
    
    channel VARCHAR(20) NOT NULL,
    status VARCHAR(20) NOT NULL,        <span class="comment">-- 'sent', 'failed'</span>
    error_message TEXT,
    
    sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
            </div>
            
            <h3>é€šçŸ¥è¨­å®šã®ä¾‹</h3>
            <table>
                <tr>
                    <th>è¨­å®šå</th>
                    <th>ãƒãƒ£ãƒ³ãƒãƒ«</th>
                    <th>ã‚¿ã‚¤ãƒ—</th>
                    <th>æ¡ä»¶</th>
                    <th>å®›å…ˆ</th>
                </tr>
                <tr>
                    <td>Criticalå³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ</td>
                    <td>Slack + Email</td>
                    <td>å³æ™‚</td>
                    <td>Immediate ã¾ãŸã¯ KEV</td>
                    <td>#security-alerts<br>security-team@</td>
                </tr>
                <tr>
                    <td>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</td>
                    <td>Slack</td>
                    <td>æ—¥æ¬¡</td>
                    <td>å…¨ã¦</td>
                    <td>#vulnerability-report</td>
                </tr>
                <tr>
                    <td>é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</td>
                    <td>Email</td>
                    <td>é€±æ¬¡</td>
                    <td>å…¨ã¦</td>
                    <td>managers@<br>audit@</td>
                </tr>
                <tr>
                    <td>æœ¬ç•ªç’°å¢ƒã‚¢ãƒ©ãƒ¼ãƒˆ</td>
                    <td>Slack</td>
                    <td>å³æ™‚</td>
                    <td>ç’°å¢ƒ=æœ¬ç•ªã€Highä»¥ä¸Š</td>
                    <td>#prod-alerts</td>
                </tr>
            </table>
        </div>

        <!-- å®šæœŸå®Ÿè¡Œã®è¨­å®š -->
        <div class="section">
            <h2>â° å®šæœŸå®Ÿè¡Œã®è¨­å®š</h2>
            
            <p style="margin-bottom: 16px;">
                æ—¥æ¬¡/é€±æ¬¡ã®é€šçŸ¥ã¯ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã§å®šæœŸå®Ÿè¡Œã—ã¾ã™ã€‚
            </p>
            
            <h3>AWS Lambda + EventBridgeã®ä¾‹</h3>
            <div class="code-block">
<span class="comment"># serverless.ymlï¼ˆServerless Frameworkï¼‰</span>
functions:
  dailySummary:
    handler: handlers.send_daily_summary
    events:
      - schedule:
          rate: cron(0 0 * * ? *)  <span class="comment"># æ¯æ—¥ 09:00 JSTï¼ˆUTC 0:00ï¼‰</span>
          enabled: true

  weeklySummary:
    handler: handlers.send_weekly_report
    events:
      - schedule:
          rate: cron(0 0 ? * MON *)  <span class="comment"># æ¯é€±æœˆæ›œ 09:00 JST</span>
          enabled: true
            </div>
            
            <h3>cronã‚¸ãƒ§ãƒ–ã®ä¾‹ï¼ˆEC2/ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ï¼‰</h3>
            <div class="code-block">
<span class="comment"># crontab -e</span>

<span class="comment"># æ—¥æ¬¡ã‚µãƒãƒªãƒ¼: æ¯æ—¥ 09:00</span>
0 9 * * * /usr/bin/python3 /app/scripts/send_daily_summary.py

<span class="comment"># é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ: æ¯é€±æœˆæ›œ 09:00</span>
0 9 * * 1 /usr/bin/python3 /app/scripts/send_weekly_report.py
            </div>
            
            <h3>æ—¥æ¬¡/é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ</h3>
            <div class="code-block">
<span class="comment"># scheduled_reports.py</span>

<span class="keyword">def</span> <span class="function">send_daily_summary</span>():
    <span class="string">"""æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã‚’é€ä¿¡"""</span>
    
    <span class="comment"># éå»24æ™‚é–“ã®ã‚µãƒãƒªãƒ¼ã‚’å–å¾—</span>
    summary = match_repo.get_daily_summary()
    
    <span class="comment"># Slacké€šçŸ¥</span>
    slack.send_daily_summary(summary)
    
    <span class="comment"># ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰</span>
    settings = settings_repo.get_by_type(NotificationType.DAILY)
    <span class="keyword">for</span> setting <span class="keyword">in</span> settings:
        <span class="keyword">if</span> setting.channel == NotificationChannel.EMAIL:
            html = render_daily_summary_email(summary)
            email.send_email(
                to=setting.recipients,
                subject=f<span class="string">"ã€æ—¥æ¬¡ã€‘è„†å¼±æ€§ã‚µãƒãƒªãƒ¼ {datetime.now().strftime('%Y/%m/%d')}"</span>,
                body_html=html
            )


<span class="keyword">def</span> <span class="function">send_weekly_report</span>():
    <span class="string">"""é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚’é€ä¿¡ï¼ˆPDFæ·»ä»˜ï¼‰"""</span>
    
    <span class="comment"># é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ</span>
    report = report_generator.generate_weekly_report()
    pdf_path = report.export_pdf()
    
    <span class="comment"># ãƒ¡ãƒ¼ãƒ«é€ä¿¡</span>
    settings = settings_repo.get_by_type(NotificationType.WEEKLY)
    <span class="keyword">for</span> setting <span class="keyword">in</span> settings:
        email.send_email(
            to=setting.recipients,
            subject=f<span class="string">"ã€é€±æ¬¡ã€‘è„†å¼±æ€§ãƒ¬ãƒãƒ¼ãƒˆ {report.period}"</span>,
            body_html=render_weekly_report_email(report),
            attachments=[pdf_path]
        )
            </div>
        </div>

        <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° -->
        <div class="section">
            <h2>âš ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªãƒˆãƒ©ã‚¤</h2>
            
            <div class="code-block">
<span class="comment"># notification_service.pyï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¿½åŠ ç‰ˆï¼‰</span>
<span class="keyword">import</span> time
<span class="keyword">from</span> functools <span class="keyword">import</span> wraps

<span class="keyword">def</span> <span class="function">retry</span>(max_attempts: int = <span class="number">3</span>, delay: float = <span class="number">1.0</span>):
    <span class="string">"""ãƒªãƒˆãƒ©ã‚¤ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿"""</span>
    <span class="keyword">def</span> <span class="function">decorator</span>(func):
        @wraps(func)
        <span class="keyword">def</span> <span class="function">wrapper</span>(*args, **kwargs):
            <span class="keyword">for</span> attempt <span class="keyword">in</span> range(max_attempts):
                <span class="keyword">try</span>:
                    <span class="keyword">return</span> func(*args, **kwargs)
                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
                    <span class="keyword">if</span> attempt == max_attempts - <span class="number">1</span>:
                        <span class="keyword">raise</span>
                    time.sleep(delay * (<span class="number">2</span> ** attempt))  <span class="comment"># æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•</span>
        <span class="keyword">return</span> wrapper
    <span class="keyword">return</span> decorator


<span class="keyword">class</span> <span class="class">NotificationService</span>:
    
    @retry(max_attempts=<span class="number">3</span>, delay=<span class="number">1.0</span>)
    <span class="keyword">def</span> <span class="function">_send_slack</span>(self, message):
        <span class="string">"""Slacké€ä¿¡ï¼ˆãƒªãƒˆãƒ©ã‚¤ä»˜ãï¼‰"""</span>
        result = self.slack.send_message(message)
        <span class="keyword">if not</span> result:
            <span class="keyword">raise</span> Exception(<span class="string">"Slacké€ä¿¡å¤±æ•—"</span>)
        <span class="keyword">return</span> result
    
    <span class="keyword">def</span> <span class="function">notify_with_fallback</span>(self, vuln, asset, priority):
        <span class="string">"""ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä»˜ãé€šçŸ¥"""</span>
        
        <span class="keyword">try</span>:
            <span class="comment"># ã¾ãšSlackã§é€šçŸ¥</span>
            self._send_slack(...)
        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:
            <span class="comment"># Slackå¤±æ•—æ™‚ã¯ãƒ¡ãƒ¼ãƒ«ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯</span>
            print(f<span class="string">"Slackå¤±æ•—ã€ãƒ¡ãƒ¼ãƒ«ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: {e}"</span>)
            self._send_email_fallback(vuln, asset, priority)
            
            <span class="comment"># ã‚¨ãƒ©ãƒ¼ã‚’è¨˜éŒ²</span>
            self._save_error_history(
                channel=<span class="string">"slack"</span>,
                error=str(e),
                vuln_id=vuln[<span class="string">"id"</span>]
            )
            </div>
            
            <div class="recommend-box">
                <h4>âœ… é€šçŸ¥ã®ä¿¡é ¼æ€§ã‚’é«˜ã‚ã‚‹ãƒã‚¤ãƒ³ãƒˆ</h4>
                <ul>
                    <li><strong>ãƒªãƒˆãƒ©ã‚¤</strong>ï¼šä¸€æ™‚çš„ãªã‚¨ãƒ©ãƒ¼ã«å¯¾å¿œï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰</li>
                    <li><strong>ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯</strong>ï¼šSlackå¤±æ•—æ™‚ã«ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡</li>
                    <li><strong>å±¥æ­´ä¿å­˜</strong>ï¼šé€ä¿¡æˆåŠŸ/å¤±æ•—ã‚’è¨˜éŒ²ã—ã¦è¿½è·¡å¯èƒ½ã«</li>
                    <li><strong>é‡è¤‡é˜²æ­¢</strong>ï¼šåŒã˜è„†å¼±æ€§ã‚’çŸ­æ™‚é–“ã«è¤‡æ•°å›é€šçŸ¥ã—ãªã„</li>
                </ul>
            </div>
        </div>

        <!-- æ‹…å½“ã‚¿ã‚¹ã‚¯ -->
        <div class="section">
            <h2>ğŸ“‹ æ‹…å½“Dã®ã‚¿ã‚¹ã‚¯</h2>
            
            <table>
                <tr>
                    <th>Sprint</th>
                    <th>ã‚¿ã‚¹ã‚¯</th>
                    <th>è©³ç´°</th>
                </tr>
                <tr>
                    <td><strong>Sprint 2</strong></td>
                    <td>é€šçŸ¥åŸºç›¤ã®è¨­è¨ˆ</td>
                    <td>
                        ãƒ»é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¯ãƒ©ã‚¹è¨­è¨ˆ<br>
                        ãƒ»é€šçŸ¥è¨­å®šDBãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ<br>
                        ãƒ»Slack Webhookè¨­å®š
                    </td>
                </tr>
                <tr>
                    <td><strong>Sprint 3</strong></td>
                    <td>å³æ™‚é€šçŸ¥ã®å®Ÿè£…</td>
                    <td>
                        ãƒ»Slacké€šçŸ¥ã®å®Ÿè£…<br>
                        ãƒ»ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã®å®Ÿè£…ï¼ˆSMTP/SESï¼‰<br>
                        ãƒ»ãƒãƒƒãƒãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã®é€£æº
                    </td>
                </tr>
                <tr>
                    <td><strong>Sprint 4</strong></td>
                    <td>å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®å®Ÿè£…</td>
                    <td>
                        ãƒ»æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã®å®Ÿè£…<br>
                        ãƒ»é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®å®Ÿè£…ï¼ˆPDFç”Ÿæˆå«ã‚€ï¼‰<br>
                        ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼è¨­å®š
                    </td>
                </tr>
                <tr>
                    <td><strong>Sprint 5</strong></td>
                    <td>é€šçŸ¥è¨­å®šUIãƒ»ãƒ†ã‚¹ãƒˆ</td>
                    <td>
                        ãƒ»é€šçŸ¥è¨­å®šç”»é¢ï¼ˆæ‹…å½“Eã¨é€£æºï¼‰<br>
                        ãƒ»ãƒ†ã‚¹ãƒˆé€šçŸ¥æ©Ÿèƒ½<br>
                        ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
                    </td>
                </tr>
            </table>
        </div>

        <!-- ã¾ã¨ã‚ -->
        <div class="section">
            <h2>ğŸ“ ã¾ã¨ã‚</h2>
            
            <table>
                <tr>
                    <th style="width: 25%;">é …ç›®</th>
                    <th>å†…å®¹</th>
                </tr>
                <tr>
                    <td><strong>Slacké€šçŸ¥</strong></td>
                    <td>Incoming Webhook ã§ã‚·ãƒ³ãƒ—ãƒ«ã«å®Ÿè£…ã€‚å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆã«æœ€é©ã€‚</td>
                </tr>
                <tr>
                    <td><strong>ãƒ¡ãƒ¼ãƒ«é€šçŸ¥</strong></td>
                    <td>SMTP ã¾ãŸã¯ AWS SESã€‚è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆãƒ»æ­£å¼é€šçŸ¥å‘ã‘ã€‚</td>
                </tr>
                <tr>
                    <td><strong>é€šçŸ¥ã®ç¨®é¡</strong></td>
                    <td>å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆã€æ—¥æ¬¡ã‚µãƒãƒªãƒ¼ã€é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®3ç¨®é¡</td>
                </tr>
                <tr>
                    <td><strong>æ¡ä»¶ãƒ•ã‚£ãƒ«ã‚¿</strong></td>
                    <td>å„ªå…ˆåº¦ã€ç’°å¢ƒã€KEVç™»éŒ²æœ‰ç„¡ã§é€šçŸ¥å¯¾è±¡ã‚’çµã‚Šè¾¼ã¿</td>
                </tr>
                <tr>
                    <td><strong>ä¿¡é ¼æ€§</strong></td>
                    <td>ãƒªãƒˆãƒ©ã‚¤ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€å±¥æ­´ä¿å­˜ã§ç¢ºå®Ÿã«é…ä¿¡</td>
                </tr>
            </table>
            
            <div class="recommend-box">
                <h4>âœ… æ¨å¥¨æ§‹æˆ</h4>
                <ul>
                    <li><strong>å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ</strong>ï¼šSlackï¼ˆCritical/KEVï¼‰+ ãƒ¡ãƒ¼ãƒ«ï¼ˆåŒæ™‚é€ä¿¡ï¼‰</li>
                    <li><strong>æ—¥æ¬¡ã‚µãƒãƒªãƒ¼</strong>ï¼šSlackï¼ˆ#vulnerability-reportãƒãƒ£ãƒ³ãƒãƒ«ï¼‰</li>
                    <li><strong>é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</strong>ï¼šãƒ¡ãƒ¼ãƒ«ï¼ˆPDFæ·»ä»˜ã€ç®¡ç†è€…ãƒ»ç›£æŸ»å‘ã‘ï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- å‚è€ƒãƒªãƒ³ã‚¯ -->
        <div class="section">
            <h2>ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯</h2>
            
            <table>
                <tr>
                    <th style="width: 30%;">ãƒªã‚½ãƒ¼ã‚¹</th>
                    <th>URL</th>
                </tr>
                <tr>
                    <td><strong>Slack Incoming Webhooks</strong></td>
                    <td><a href="https://api.slack.com/messaging/webhooks" target="_blank">https://api.slack.com/messaging/webhooks</a></td>
                </tr>
                <tr>
                    <td><strong>Slack Block Kit Builder</strong></td>
                    <td><a href="https://app.slack.com/block-kit-builder" target="_blank">https://app.slack.com/block-kit-builder</a></td>
                </tr>
                <tr>
                    <td><strong>AWS SES ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</strong></td>
                    <td><a href="https://docs.aws.amazon.com/ses/" target="_blank">https://docs.aws.amazon.com/ses/</a></td>
                </tr>
                <